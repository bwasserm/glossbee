   1               		.file	"bmac.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__RAMPZ__ = 0x3b
   6               	__tmp_reg__ = 0
   7               	__zero_reg__ = 1
  10               		.text
  11               	.Ltext0:
 339               	.global	rf_rx_callback
 341               	rf_rx_callback:
 342               		.stabd	46,0,0
   1:../../../src/net/bmac/rf231_soc/bmac.c **** /******************************************************************************
   2:../../../src/net/bmac/rf231_soc/bmac.c **** *  Nano-RK, a real-time operating system for sensor networks.
   3:../../../src/net/bmac/rf231_soc/bmac.c **** *  Copyright (C) 2007, Real-Time and Multimedia Lab, Carnegie Mellon University
   4:../../../src/net/bmac/rf231_soc/bmac.c **** *  All rights reserved.
   5:../../../src/net/bmac/rf231_soc/bmac.c **** *
   6:../../../src/net/bmac/rf231_soc/bmac.c **** *  This is the Open Source Version of Nano-RK included as part of a Dual
   7:../../../src/net/bmac/rf231_soc/bmac.c **** *  Licensing Model. If you are unsure which license to use please refer to:
   8:../../../src/net/bmac/rf231_soc/bmac.c **** *  http://www.nanork.org/nano-RK/wiki/Licensing
   9:../../../src/net/bmac/rf231_soc/bmac.c **** *
  10:../../../src/net/bmac/rf231_soc/bmac.c **** *  This program is free software: you can redistribute it and/or modify
  11:../../../src/net/bmac/rf231_soc/bmac.c **** *  it under the terms of the GNU General Public License as published by
  12:../../../src/net/bmac/rf231_soc/bmac.c **** *  the Free Software Foundation, version 2.0 of the License.
  13:../../../src/net/bmac/rf231_soc/bmac.c **** *
  14:../../../src/net/bmac/rf231_soc/bmac.c **** *  This program is distributed in the hope that it will be useful,
  15:../../../src/net/bmac/rf231_soc/bmac.c **** *  but WITHOUT ANY WARRANTY; without even the implied warranty of
  16:../../../src/net/bmac/rf231_soc/bmac.c **** *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  17:../../../src/net/bmac/rf231_soc/bmac.c **** *  GNU General Public License for more details.
  18:../../../src/net/bmac/rf231_soc/bmac.c **** *
  19:../../../src/net/bmac/rf231_soc/bmac.c **** *  You should have received a copy of the GNU General Public License
  20:../../../src/net/bmac/rf231_soc/bmac.c **** *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
  21:../../../src/net/bmac/rf231_soc/bmac.c **** *
  22:../../../src/net/bmac/rf231_soc/bmac.c **** *  Contributing Authors (specific to this file):
  23:../../../src/net/bmac/rf231_soc/bmac.c **** *  Anthony Rowe
  24:../../../src/net/bmac/rf231_soc/bmac.c **** *******************************************************************************/
  25:../../../src/net/bmac/rf231_soc/bmac.c **** 
  26:../../../src/net/bmac/rf231_soc/bmac.c **** 
  27:../../../src/net/bmac/rf231_soc/bmac.c **** 
  28:../../../src/net/bmac/rf231_soc/bmac.c **** #include <include.h>
  29:../../../src/net/bmac/rf231_soc/bmac.c **** #include <ulib.h>
  30:../../../src/net/bmac/rf231_soc/bmac.c **** #include <stdlib.h>
  31:../../../src/net/bmac/rf231_soc/bmac.c **** #include <avr/sleep.h>
  32:../../../src/net/bmac/rf231_soc/bmac.c **** #include <avr/wdt.h>
  33:../../../src/net/bmac/rf231_soc/bmac.c **** #include <avr/eeprom.h>
  34:../../../src/net/bmac/rf231_soc/bmac.c **** #include <stdio.h>
  35:../../../src/net/bmac/rf231_soc/bmac.c **** #include <avr/interrupt.h>
  36:../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk.h>
  37:../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_events.h>
  38:../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_timer.h>
  39:../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_error.h>
  40:../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_reserve.h>
  41:../../../src/net/bmac/rf231_soc/bmac.c **** #include <bmac.h>
  42:../../../src/net/bmac/rf231_soc/bmac.c **** #include <nrk_cfg.h>
  43:../../../src/net/bmac/rf231_soc/bmac.c **** 
  44:../../../src/net/bmac/rf231_soc/bmac.c **** 
  45:../../../src/net/bmac/rf231_soc/bmac.c **** #ifndef BMAC_STACKSIZE
  46:../../../src/net/bmac/rf231_soc/bmac.c **** #define BMAC_STACKSIZE 128
  47:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
  48:../../../src/net/bmac/rf231_soc/bmac.c **** 
  49:../../../src/net/bmac/rf231_soc/bmac.c **** static nrk_task_type bmac_task;
  50:../../../src/net/bmac/rf231_soc/bmac.c **** static NRK_STK bmac_task_stack[BMAC_STACKSIZE];
  51:../../../src/net/bmac/rf231_soc/bmac.c **** 
  52:../../../src/net/bmac/rf231_soc/bmac.c **** 
  53:../../../src/net/bmac/rf231_soc/bmac.c **** //#define DEBUG
  54:../../../src/net/bmac/rf231_soc/bmac.c **** static uint32_t rx_failure_cnt;
  55:../../../src/net/bmac/rf231_soc/bmac.c **** 
  56:../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t tx_data_ready;
  57:../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t rx_buf_empty;
  58:../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t bmac_running;
  59:../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t pkt_got_ack;
  60:../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t g_chan;
  61:../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t is_enabled;
  62:../../../src/net/bmac/rf231_soc/bmac.c **** 
  63:../../../src/net/bmac/rf231_soc/bmac.c **** static nrk_time_t _bmac_check_period;
  64:../../../src/net/bmac/rf231_soc/bmac.c **** 
  65:../../../src/net/bmac/rf231_soc/bmac.c **** static uint8_t cca_active;
  66:../../../src/net/bmac/rf231_soc/bmac.c **** static int8_t tx_reserve;
  67:../../../src/net/bmac/rf231_soc/bmac.c **** 
  68:../../../src/net/bmac/rf231_soc/bmac.c **** static nrk_time_t dummy_t;
  69:../../../src/net/bmac/rf231_soc/bmac.c **** 
  70:../../../src/net/bmac/rf231_soc/bmac.c **** /**
  71:../../../src/net/bmac/rf231_soc/bmac.c ****  *  This is a callback if you require immediate response to a packet
  72:../../../src/net/bmac/rf231_soc/bmac.c ****  */
  73:../../../src/net/bmac/rf231_soc/bmac.c **** RF_RX_INFO *rf_rx_callback (RF_RX_INFO * pRRI)
  74:../../../src/net/bmac/rf231_soc/bmac.c **** {
 344               	.LM0:
 345               	.LFBB1:
 346               	/* prologue: function */
 347               	/* frame size = 0 */
 348               	/* stack size = 0 */
 349               	.L__stack_usage = 0
  75:../../../src/net/bmac/rf231_soc/bmac.c ****   // Any code here gets called the instant a packet is received from the interrupt   
  76:../../../src/net/bmac/rf231_soc/bmac.c ****   return pRRI;
  77:../../../src/net/bmac/rf231_soc/bmac.c **** }
 351               	.LM1:
 352 0000 0895      		ret
 354               	.Lscope1:
 356               		.stabd	78,0,0
 360               	.global	bmac_encryption_set_ctr_counter
 362               	bmac_encryption_set_ctr_counter:
 363               		.stabd	46,0,0
  78:../../../src/net/bmac/rf231_soc/bmac.c **** 
  79:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_encryption_set_ctr_counter (uint8_t * counter, uint8_t len)
  80:../../../src/net/bmac/rf231_soc/bmac.c **** {
 365               	.LM2:
 366               	.LFBB2:
 367               	/* prologue: function */
 368               	/* frame size = 0 */
 369               	/* stack size = 0 */
 370               	.L__stack_usage = 0
  81:../../../src/net/bmac/rf231_soc/bmac.c ****   if (len != 4)
 372               	.LM3:
 373 0002 6430      		cpi r22,lo8(4)
 374 0004 01F4      		brne .L4
  82:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
  83:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_security_set_ctr_counter (counter);
 376               	.LM4:
 377 0006 0E94 0000 		call rf_security_set_ctr_counter
  84:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 379               	.LM5:
 380 000a 81E0      		ldi r24,lo8(1)
 381 000c 0895      		ret
 382               	.L4:
  82:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 384               	.LM6:
 385 000e 8FEF      		ldi r24,lo8(-1)
  85:../../../src/net/bmac/rf231_soc/bmac.c **** }
 387               	.LM7:
 388 0010 0895      		ret
 390               	.Lscope2:
 392               		.stabd	78,0,0
 396               	.global	bmac_tx_reserve_set
 398               	bmac_tx_reserve_set:
 399               		.stabd	46,0,0
  86:../../../src/net/bmac/rf231_soc/bmac.c **** 
  87:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_tx_reserve_set (nrk_time_t * period, uint16_t pkts)
  88:../../../src/net/bmac/rf231_soc/bmac.c **** {
 401               	.LM8:
 402               	.LFBB3:
 403               	/* prologue: function */
 404               	/* frame size = 0 */
 405               	/* stack size = 0 */
 406               	.L__stack_usage = 0
  89:../../../src/net/bmac/rf231_soc/bmac.c **** 
  90:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_MAX_RESERVES
  91:../../../src/net/bmac/rf231_soc/bmac.c **** // Create a reserve if it doesn't exist
  92:../../../src/net/bmac/rf231_soc/bmac.c ****   if (tx_reserve == -1)
  93:../../../src/net/bmac/rf231_soc/bmac.c ****     tx_reserve = nrk_reserve_create ();
  94:../../../src/net/bmac/rf231_soc/bmac.c ****   if (tx_reserve >= 0)
  95:../../../src/net/bmac/rf231_soc/bmac.c ****     return nrk_reserve_set (tx_reserve, period, pkts, NULL);
  96:../../../src/net/bmac/rf231_soc/bmac.c ****   else
  97:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
  98:../../../src/net/bmac/rf231_soc/bmac.c **** #else
  99:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_ERROR;
 100:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 101:../../../src/net/bmac/rf231_soc/bmac.c **** }
 408               	.LM9:
 409 0012 8FEF      		ldi r24,lo8(-1)
 410 0014 0895      		ret
 412               	.Lscope3:
 414               		.stabd	78,0,0
 416               	.global	bmac_tx_reserve_get
 418               	bmac_tx_reserve_get:
 419               		.stabd	46,0,0
 102:../../../src/net/bmac/rf231_soc/bmac.c **** 
 103:../../../src/net/bmac/rf231_soc/bmac.c **** uint16_t bmac_tx_reserve_get ()
 104:../../../src/net/bmac/rf231_soc/bmac.c **** {
 421               	.LM10:
 422               	.LFBB4:
 423               	/* prologue: function */
 424               	/* frame size = 0 */
 425               	/* stack size = 0 */
 426               	.L__stack_usage = 0
 105:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_MAX_RESERVES
 106:../../../src/net/bmac/rf231_soc/bmac.c ****   if (tx_reserve >= 0)
 107:../../../src/net/bmac/rf231_soc/bmac.c ****     return nrk_reserve_get (tx_reserve);
 108:../../../src/net/bmac/rf231_soc/bmac.c ****   else
 109:../../../src/net/bmac/rf231_soc/bmac.c ****     return 0;
 110:../../../src/net/bmac/rf231_soc/bmac.c **** #else
 111:../../../src/net/bmac/rf231_soc/bmac.c ****   return 0;
 112:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 113:../../../src/net/bmac/rf231_soc/bmac.c **** }
 428               	.LM11:
 429 0016 80E0      		ldi r24,0
 430 0018 90E0      		ldi r25,0
 431 001a 0895      		ret
 433               	.Lscope4:
 435               		.stabd	78,0,0
 437               	.global	bmac_auto_ack_disable
 439               	bmac_auto_ack_disable:
 440               		.stabd	46,0,0
 114:../../../src/net/bmac/rf231_soc/bmac.c **** 
 115:../../../src/net/bmac/rf231_soc/bmac.c **** 
 116:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_auto_ack_disable ()
 117:../../../src/net/bmac/rf231_soc/bmac.c **** {
 442               	.LM12:
 443               	.LFBB5:
 444               	/* prologue: function */
 445               	/* frame size = 0 */
 446               	/* stack size = 0 */
 447               	.L__stack_usage = 0
 118:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_auto_ack_disable ();
 449               	.LM13:
 450 001c 0E94 0000 		call rf_auto_ack_disable
 119:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 120:../../../src/net/bmac/rf231_soc/bmac.c **** }
 452               	.LM14:
 453 0020 81E0      		ldi r24,lo8(1)
 454 0022 0895      		ret
 456               	.Lscope5:
 458               		.stabd	78,0,0
 460               	.global	bmac_auto_ack_enable
 462               	bmac_auto_ack_enable:
 463               		.stabd	46,0,0
 121:../../../src/net/bmac/rf231_soc/bmac.c **** 
 122:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_auto_ack_enable ()
 123:../../../src/net/bmac/rf231_soc/bmac.c **** {
 465               	.LM15:
 466               	.LFBB6:
 467               	/* prologue: function */
 468               	/* frame size = 0 */
 469               	/* stack size = 0 */
 470               	.L__stack_usage = 0
 124:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_auto_ack_enable ();
 472               	.LM16:
 473 0024 0E94 0000 		call rf_auto_ack_enable
 125:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 126:../../../src/net/bmac/rf231_soc/bmac.c **** }
 475               	.LM17:
 476 0028 81E0      		ldi r24,lo8(1)
 477 002a 0895      		ret
 479               	.Lscope6:
 481               		.stabd	78,0,0
 483               	.global	bmac_addr_decode_disable
 485               	bmac_addr_decode_disable:
 486               		.stabd	46,0,0
 127:../../../src/net/bmac/rf231_soc/bmac.c **** 
 128:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_addr_decode_disable ()
 129:../../../src/net/bmac/rf231_soc/bmac.c **** {
 488               	.LM18:
 489               	.LFBB7:
 490               	/* prologue: function */
 491               	/* frame size = 0 */
 492               	/* stack size = 0 */
 493               	.L__stack_usage = 0
 130:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_addr_decode_disable ();
 495               	.LM19:
 496 002c 0E94 0000 		call rf_addr_decode_disable
 131:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 132:../../../src/net/bmac/rf231_soc/bmac.c **** }
 498               	.LM20:
 499 0030 81E0      		ldi r24,lo8(1)
 500 0032 0895      		ret
 502               	.Lscope7:
 504               		.stabd	78,0,0
 506               	.global	bmac_addr_decode_enable
 508               	bmac_addr_decode_enable:
 509               		.stabd	46,0,0
 133:../../../src/net/bmac/rf231_soc/bmac.c **** 
 134:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_addr_decode_enable ()
 135:../../../src/net/bmac/rf231_soc/bmac.c **** {
 511               	.LM21:
 512               	.LFBB8:
 513               	/* prologue: function */
 514               	/* frame size = 0 */
 515               	/* stack size = 0 */
 516               	.L__stack_usage = 0
 136:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_addr_decode_enable ();
 518               	.LM22:
 519 0034 0E94 0000 		call rf_addr_decode_enable
 137:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 138:../../../src/net/bmac/rf231_soc/bmac.c **** }
 521               	.LM23:
 522 0038 81E0      		ldi r24,lo8(1)
 523 003a 0895      		ret
 525               	.Lscope8:
 527               		.stabd	78,0,0
 530               	.global	bmac_addr_decode_set_my_mac
 532               	bmac_addr_decode_set_my_mac:
 533               		.stabd	46,0,0
 139:../../../src/net/bmac/rf231_soc/bmac.c **** 
 140:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_addr_decode_set_my_mac (uint16_t my_mac)
 141:../../../src/net/bmac/rf231_soc/bmac.c **** {
 535               	.LM24:
 536               	.LFBB9:
 537               	/* prologue: function */
 538               	/* frame size = 0 */
 539               	/* stack size = 0 */
 540               	.L__stack_usage = 0
 142:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_addr_decode_set_my_mac (my_mac);
 542               	.LM25:
 543 003c 0E94 0000 		call rf_addr_decode_set_my_mac
 143:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 144:../../../src/net/bmac/rf231_soc/bmac.c **** }
 545               	.LM26:
 546 0040 81E0      		ldi r24,lo8(1)
 547 0042 0895      		ret
 549               	.Lscope9:
 551               		.stabd	78,0,0
 554               	.global	bmac_addr_decode_dest_mac
 556               	bmac_addr_decode_dest_mac:
 557               		.stabd	46,0,0
 145:../../../src/net/bmac/rf231_soc/bmac.c **** 
 146:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_addr_decode_dest_mac (uint16_t dest)
 147:../../../src/net/bmac/rf231_soc/bmac.c **** {
 559               	.LM27:
 560               	.LFBB10:
 561               	/* prologue: function */
 562               	/* frame size = 0 */
 563               	/* stack size = 0 */
 564               	.L__stack_usage = 0
 148:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.destAddr = dest;
 566               	.LM28:
 567 0044 9093 0000 		sts bmac_rfTxInfo+1,r25
 568 0048 8093 0000 		sts bmac_rfTxInfo,r24
 149:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 150:../../../src/net/bmac/rf231_soc/bmac.c **** }
 570               	.LM29:
 571 004c 81E0      		ldi r24,lo8(1)
 572 004e 0895      		ret
 574               	.Lscope10:
 576               		.stabd	78,0,0
 578               	.global	bmac_rx_pkt_is_encrypted
 580               	bmac_rx_pkt_is_encrypted:
 581               		.stabd	46,0,0
 151:../../../src/net/bmac/rf231_soc/bmac.c **** 
 152:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_rx_pkt_is_encrypted ()
 153:../../../src/net/bmac/rf231_soc/bmac.c **** {
 583               	.LM30:
 584               	.LFBB11:
 585               	/* prologue: function */
 586               	/* frame size = 0 */
 587               	/* stack size = 0 */
 588               	.L__stack_usage = 0
 154:../../../src/net/bmac/rf231_soc/bmac.c ****   return rf_security_last_pkt_status ();
 590               	.LM31:
 591 0050 0E94 0000 		call rf_security_last_pkt_status
 155:../../../src/net/bmac/rf231_soc/bmac.c **** }
 593               	.LM32:
 594 0054 0895      		ret
 596               	.Lscope11:
 598               		.stabd	78,0,0
 602               	.global	bmac_encryption_set_key
 604               	bmac_encryption_set_key:
 605               		.stabd	46,0,0
 156:../../../src/net/bmac/rf231_soc/bmac.c **** 
 157:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_encryption_set_key (uint8_t * key, uint8_t len)
 158:../../../src/net/bmac/rf231_soc/bmac.c **** {
 607               	.LM33:
 608               	.LFBB12:
 609               	/* prologue: function */
 610               	/* frame size = 0 */
 611               	/* stack size = 0 */
 612               	.L__stack_usage = 0
 159:../../../src/net/bmac/rf231_soc/bmac.c ****   if (len != 16)
 614               	.LM34:
 615 0056 6031      		cpi r22,lo8(16)
 616 0058 01F4      		brne .L17
 160:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 161:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_security_set_key (key);
 618               	.LM35:
 619 005a 0E94 0000 		call rf_security_set_key
 162:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 621               	.LM36:
 622 005e 81E0      		ldi r24,lo8(1)
 623 0060 0895      		ret
 624               	.L17:
 160:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 626               	.LM37:
 627 0062 8FEF      		ldi r24,lo8(-1)
 163:../../../src/net/bmac/rf231_soc/bmac.c **** }
 629               	.LM38:
 630 0064 0895      		ret
 632               	.Lscope12:
 634               		.stabd	78,0,0
 636               	.global	bmac_encryption_enable
 638               	bmac_encryption_enable:
 639               		.stabd	46,0,0
 164:../../../src/net/bmac/rf231_soc/bmac.c **** 
 165:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_encryption_enable ()
 166:../../../src/net/bmac/rf231_soc/bmac.c **** {
 641               	.LM39:
 642               	.LFBB13:
 643               	/* prologue: function */
 644               	/* frame size = 0 */
 645               	/* stack size = 0 */
 646               	.L__stack_usage = 0
 167:../../../src/net/bmac/rf231_soc/bmac.c ****   //rf_security_enable();
 168:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 169:../../../src/net/bmac/rf231_soc/bmac.c **** }
 648               	.LM40:
 649 0066 81E0      		ldi r24,lo8(1)
 650 0068 0895      		ret
 652               	.Lscope13:
 654               		.stabd	78,0,0
 656               	.global	bmac_encryption_disable
 658               	bmac_encryption_disable:
 659               		.stabd	46,0,0
 170:../../../src/net/bmac/rf231_soc/bmac.c **** 
 171:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_encryption_disable ()
 172:../../../src/net/bmac/rf231_soc/bmac.c **** {
 661               	.LM41:
 662               	.LFBB14:
 663               	/* prologue: function */
 664               	/* frame size = 0 */
 665               	/* stack size = 0 */
 666               	.L__stack_usage = 0
 173:../../../src/net/bmac/rf231_soc/bmac.c ****   //rf_security_disable();
 174:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 175:../../../src/net/bmac/rf231_soc/bmac.c **** }
 668               	.LM42:
 669 006a 81E0      		ldi r24,lo8(1)
 670 006c 0895      		ret
 672               	.Lscope14:
 674               		.stabd	78,0,0
 677               	.global	bmac_set_rf_power
 679               	bmac_set_rf_power:
 680               		.stabd	46,0,0
 176:../../../src/net/bmac/rf231_soc/bmac.c **** 
 177:../../../src/net/bmac/rf231_soc/bmac.c **** 
 178:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_set_rf_power (uint8_t power)
 179:../../../src/net/bmac/rf231_soc/bmac.c **** {
 682               	.LM43:
 683               	.LFBB15:
 684               	/* prologue: function */
 685               	/* frame size = 0 */
 686               	/* stack size = 0 */
 687               	.L__stack_usage = 0
 180:../../../src/net/bmac/rf231_soc/bmac.c ****   if (power > 31)
 689               	.LM44:
 690 006e 8032      		cpi r24,lo8(32)
 691 0070 00F4      		brsh .L22
 181:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 182:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_tx_power (power);
 693               	.LM45:
 694 0072 0E94 0000 		call rf_tx_power
 183:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 696               	.LM46:
 697 0076 81E0      		ldi r24,lo8(1)
 698 0078 0895      		ret
 699               	.L22:
 181:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 701               	.LM47:
 702 007a 8FEF      		ldi r24,lo8(-1)
 184:../../../src/net/bmac/rf231_soc/bmac.c **** }
 704               	.LM48:
 705 007c 0895      		ret
 707               	.Lscope15:
 709               		.stabd	78,0,0
 712               	.global	bmac_set_cca_active
 714               	bmac_set_cca_active:
 715               		.stabd	46,0,0
 185:../../../src/net/bmac/rf231_soc/bmac.c **** 
 186:../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_set_cca_active (uint8_t active)
 187:../../../src/net/bmac/rf231_soc/bmac.c **** {
 717               	.LM49:
 718               	.LFBB16:
 719               	/* prologue: function */
 720               	/* frame size = 0 */
 721               	/* stack size = 0 */
 722               	.L__stack_usage = 0
 188:../../../src/net/bmac/rf231_soc/bmac.c ****   cca_active = active;
 724               	.LM50:
 725 007e 8093 0000 		sts cca_active,r24
 726 0082 0895      		ret
 728               	.Lscope16:
 730               		.stabd	78,0,0
 733               	.global	bmac_set_cca_thresh
 735               	bmac_set_cca_thresh:
 736               		.stabd	46,0,0
 189:../../../src/net/bmac/rf231_soc/bmac.c **** }
 190:../../../src/net/bmac/rf231_soc/bmac.c **** 
 191:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_set_cca_thresh (int8_t thresh)
 192:../../../src/net/bmac/rf231_soc/bmac.c **** {
 738               	.LM51:
 739               	.LFBB17:
 740               	/* prologue: function */
 741               	/* frame size = 0 */
 742               	/* stack size = 0 */
 743               	.L__stack_usage = 0
 193:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_set_cca_thresh (thresh);
 745               	.LM52:
 746 0084 9927      		clr r25
 747 0086 87FD      		sbrc r24,7
 748 0088 9095      		com r25
 749 008a 0E94 0000 		call rf_set_cca_thresh
 194:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 195:../../../src/net/bmac/rf231_soc/bmac.c **** }
 751               	.LM53:
 752 008e 81E0      		ldi r24,lo8(1)
 753 0090 0895      		ret
 755               	.Lscope17:
 757               		.stabd	78,0,0
 760               	.global	bmac_set_channel
 762               	bmac_set_channel:
 763               		.stabd	46,0,0
 196:../../../src/net/bmac/rf231_soc/bmac.c **** 
 197:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_set_channel (uint8_t chan)
 198:../../../src/net/bmac/rf231_soc/bmac.c **** {
 765               	.LM54:
 766               	.LFBB18:
 767 0092 CF93      		push r28
 768 0094 DF93      		push r29
 769 0096 1F92      		push __zero_reg__
 770 0098 CDB7      		in r28,__SP_L__
 771 009a DEB7      		in r29,__SP_H__
 772               	/* prologue: function */
 773               	/* frame size = 1 */
 774               	/* stack size = 3 */
 775               	.L__stack_usage = 3
 199:../../../src/net/bmac/rf231_soc/bmac.c ****   if (chan > 26)
 777               	.LM55:
 778 009c 8B31      		cpi r24,lo8(27)
 779 009e 00F4      		brsh .L27
 200:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 201:../../../src/net/bmac/rf231_soc/bmac.c ****   g_chan = chan;
 781               	.LM56:
 782 00a0 8093 0000 		sts g_chan,r24
 202:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_power_up ();
 784               	.LM57:
 785 00a4 8983      		std Y+1,r24
 786 00a6 0E94 0000 		call rf_power_up
 203:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_init (&bmac_rfRxInfo, chan, 0xFFFF, 0x00000);
 788               	.LM58:
 789 00aa 20E0      		ldi r18,0
 790 00ac 30E0      		ldi r19,0
 791 00ae 4FEF      		ldi r20,lo8(-1)
 792 00b0 5FEF      		ldi r21,lo8(-1)
 793 00b2 8981      		ldd r24,Y+1
 794 00b4 682F      		mov r22,r24
 795 00b6 80E0      		ldi r24,lo8(bmac_rfRxInfo)
 796 00b8 90E0      		ldi r25,hi8(bmac_rfRxInfo)
 797 00ba 0E94 0000 		call rf_init
 204:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 799               	.LM59:
 800 00be 81E0      		ldi r24,lo8(1)
 801 00c0 00C0      		rjmp .L26
 802               	.L27:
 200:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 804               	.LM60:
 805 00c2 8FEF      		ldi r24,lo8(-1)
 806               	.L26:
 807               	/* epilogue start */
 205:../../../src/net/bmac/rf231_soc/bmac.c **** }
 809               	.LM61:
 810 00c4 0F90      		pop __tmp_reg__
 811 00c6 DF91      		pop r29
 812 00c8 CF91      		pop r28
 813 00ca 0895      		ret
 815               	.Lscope18:
 817               		.stabd	78,0,0
 819               	.global	bmac_wait_until_rx_pkt
 821               	bmac_wait_until_rx_pkt:
 822               		.stabd	46,0,0
 206:../../../src/net/bmac/rf231_soc/bmac.c **** 
 207:../../../src/net/bmac/rf231_soc/bmac.c **** 
 208:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_wait_until_rx_pkt ()
 209:../../../src/net/bmac/rf231_soc/bmac.c **** {
 824               	.LM62:
 825               	.LFBB19:
 826               	/* prologue: function */
 827               	/* frame size = 0 */
 828               	/* stack size = 0 */
 829               	.L__stack_usage = 0
 210:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_sig_mask_t event;
 211:../../../src/net/bmac/rf231_soc/bmac.c **** 
 212:../../../src/net/bmac/rf231_soc/bmac.c ****   if (bmac_rx_pkt_ready () == 1)
 831               	.LM63:
 832 00cc 8091 0000 		lds r24,rx_buf_empty
 833 00d0 8823      		tst r24
 834 00d2 01F0      		breq .L31
 213:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_OK;
 214:../../../src/net/bmac/rf231_soc/bmac.c **** 
 215:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_signal_register (bmac_rx_pkt_signal);
 836               	.LM64:
 837 00d4 8091 0000 		lds r24,bmac_rx_pkt_signal
 838 00d8 0E94 0000 		call nrk_signal_register
 216:../../../src/net/bmac/rf231_soc/bmac.c ****   event = nrk_event_wait (SIG (bmac_rx_pkt_signal));
 840               	.LM65:
 841 00dc 61E0      		ldi r22,lo8(1)
 842 00de 70E0      		ldi r23,0
 843 00e0 80E0      		ldi r24,0
 844 00e2 90E0      		ldi r25,0
 845 00e4 0090 0000 		lds r0,bmac_rx_pkt_signal
 846 00e8 00C0      		rjmp 2f
 847               		1:
 848 00ea 660F      		lsl r22
 849 00ec 771F      		rol r23
 850 00ee 881F      		rol r24
 851 00f0 991F      		rol r25
 852               		2:
 853 00f2 0A94      		dec r0
 854 00f4 02F4      		brpl 1b
 855 00f6 0E94 0000 		call nrk_event_wait
 217:../../../src/net/bmac/rf231_soc/bmac.c **** 
 218:../../../src/net/bmac/rf231_soc/bmac.c **** // Check if it was a time out instead of packet RX signal
 219:../../../src/net/bmac/rf231_soc/bmac.c ****   if ((event & SIG (bmac_rx_pkt_signal)) == 0)
 857               	.LM66:
 858 00fa 0090 0000 		lds r0,bmac_rx_pkt_signal
 859 00fe 00C0      		rjmp 2f
 860               		1:
 861 0100 9695      		lsr r25
 862 0102 8795      		ror r24
 863 0104 7795      		ror r23
 864 0106 6795      		ror r22
 865               		2:
 866 0108 0A94      		dec r0
 867 010a 02F4      		brpl 1b
 868 010c 60FD      		sbrc r22,0
 869 010e 00C0      		rjmp .L31
 220:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 871               	.LM67:
 872 0110 8FEF      		ldi r24,lo8(-1)
 873 0112 0895      		ret
 874               	.L31:
 221:../../../src/net/bmac/rf231_soc/bmac.c ****   else
 222:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_OK;
 876               	.LM68:
 877 0114 81E0      		ldi r24,lo8(1)
 223:../../../src/net/bmac/rf231_soc/bmac.c **** }
 879               	.LM69:
 880 0116 0895      		ret
 882               	.Lscope19:
 884               		.stabd	78,0,0
 888               	.global	bmac_rx_pkt_set_buffer
 890               	bmac_rx_pkt_set_buffer:
 891               		.stabd	46,0,0
 224:../../../src/net/bmac/rf231_soc/bmac.c **** 
 225:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_rx_pkt_set_buffer (uint8_t * buf, uint8_t size)
 226:../../../src/net/bmac/rf231_soc/bmac.c **** {
 893               	.LM70:
 894               	.LFBB20:
 895               	/* prologue: function */
 896               	/* frame size = 0 */
 897               	/* stack size = 0 */
 898               	.L__stack_usage = 0
 227:../../../src/net/bmac/rf231_soc/bmac.c ****   if (buf == NULL)
 900               	.LM71:
 901 0118 0097      		sbiw r24,0
 902 011a 01F0      		breq .L34
 228:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 229:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfRxInfo.pPayload = buf;
 904               	.LM72:
 905 011c 9093 0000 		sts bmac_rfRxInfo+5+1,r25
 906 0120 8093 0000 		sts bmac_rfRxInfo+5,r24
 230:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfRxInfo.max_length = size;
 908               	.LM73:
 909 0124 6093 0000 		sts bmac_rfRxInfo+4,r22
 231:../../../src/net/bmac/rf231_soc/bmac.c ****   rx_buf_empty = 1;
 911               	.LM74:
 912 0128 81E0      		ldi r24,lo8(1)
 913 012a 8093 0000 		sts rx_buf_empty,r24
 232:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 915               	.LM75:
 916 012e 0895      		ret
 917               	.L34:
 228:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 919               	.LM76:
 920 0130 8FEF      		ldi r24,lo8(-1)
 233:../../../src/net/bmac/rf231_soc/bmac.c **** }
 922               	.LM77:
 923 0132 0895      		ret
 925               	.Lscope20:
 927               		.stabd	78,0,0
 930               	.global	bmac_init
 932               	bmac_init:
 933               		.stabd	46,0,0
 234:../../../src/net/bmac/rf231_soc/bmac.c **** 
 235:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_init (uint8_t chan)
 236:../../../src/net/bmac/rf231_soc/bmac.c **** {
 935               	.LM78:
 936               	.LFBB21:
 937 0134 CF93      		push r28
 938 0136 DF93      		push r29
 939               	/* prologue: function */
 940               	/* frame size = 0 */
 941               	/* stack size = 2 */
 942               	.L__stack_usage = 2
 943 0138 D82F      		mov r29,r24
 237:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_running = 0;
 945               	.LM79:
 946 013a 1092 0000 		sts bmac_running,__zero_reg__
 238:../../../src/net/bmac/rf231_soc/bmac.c ****   tx_reserve = -1;
 948               	.LM80:
 949 013e 8FEF      		ldi r24,lo8(-1)
 950 0140 8093 0000 		sts tx_reserve,r24
 239:../../../src/net/bmac/rf231_soc/bmac.c ****   cca_active = true;
 952               	.LM81:
 953 0144 C1E0      		ldi r28,lo8(1)
 954 0146 C093 0000 		sts cca_active,r28
 240:../../../src/net/bmac/rf231_soc/bmac.c ****   rx_failure_cnt = 0;
 956               	.LM82:
 957 014a 1092 0000 		sts rx_failure_cnt,__zero_reg__
 958 014e 1092 0000 		sts rx_failure_cnt+1,__zero_reg__
 959 0152 1092 0000 		sts rx_failure_cnt+2,__zero_reg__
 960 0156 1092 0000 		sts rx_failure_cnt+3,__zero_reg__
 241:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_SW_WDT
 242:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef BMAC_SW_WDT_ID
 243:../../../src/net/bmac/rf231_soc/bmac.c **** 
 244:../../../src/net/bmac/rf231_soc/bmac.c ****   _bmac_check_period.secs = 30;
 245:../../../src/net/bmac/rf231_soc/bmac.c ****   _bmac_check_period.nano_secs = 0;
 246:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_sw_wdt_init (BMAC_SW_WDT_ID, &_bmac_check_period, NULL);
 247:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_sw_wdt_start (BMAC_SW_WDT_ID);
 248:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 249:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 250:../../../src/net/bmac/rf231_soc/bmac.c **** 
 251:../../../src/net/bmac/rf231_soc/bmac.c **** 
 252:../../../src/net/bmac/rf231_soc/bmac.c **** 
 253:../../../src/net/bmac/rf231_soc/bmac.c ****   _bmac_check_period.secs = 0;
 962               	.LM83:
 963 015a 1092 0000 		sts _bmac_check_period,__zero_reg__
 964 015e 1092 0000 		sts _bmac_check_period+1,__zero_reg__
 965 0162 1092 0000 		sts _bmac_check_period+2,__zero_reg__
 966 0166 1092 0000 		sts _bmac_check_period+3,__zero_reg__
 254:../../../src/net/bmac/rf231_soc/bmac.c ****   _bmac_check_period.nano_secs = BMAC_DEFAULT_CHECK_RATE_MS * NANOS_PER_MS;
 968               	.LM84:
 969 016a 40E0      		ldi r20,0
 970 016c 51EE      		ldi r21,lo8(-31)
 971 016e 65EF      		ldi r22,lo8(-11)
 972 0170 75E0      		ldi r23,lo8(5)
 973 0172 4093 0000 		sts _bmac_check_period+4,r20
 974 0176 5093 0000 		sts _bmac_check_period+4+1,r21
 975 017a 6093 0000 		sts _bmac_check_period+4+2,r22
 976 017e 7093 0000 		sts _bmac_check_period+4+3,r23
 255:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rx_pkt_signal = nrk_signal_create ();
 978               	.LM85:
 979 0182 0E94 0000 		call nrk_signal_create
 980 0186 8093 0000 		sts bmac_rx_pkt_signal,r24
 256:../../../src/net/bmac/rf231_soc/bmac.c ****   if (bmac_rx_pkt_signal == NRK_ERROR) {
 982               	.LM86:
 983 018a 8F3F      		cpi r24,lo8(-1)
 984 018c 01F4      		brne .L36
 257:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kprintf (PSTR ("BMAC ERROR: creating rx signal failed\r\n"));
 986               	.LM87:
 987 018e 80E0      		ldi r24,lo8(__c.3589)
 988 0190 90E0      		ldi r25,hi8(__c.3589)
 989 0192 00C0      		rjmp .L40
 990               	.L36:
 258:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kernel_error_add (NRK_SIGNAL_CREATE_ERROR, nrk_cur_task_TCB->task_ID);
 259:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 260:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 261:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_tx_pkt_done_signal = nrk_signal_create ();
 992               	.LM88:
 993 0194 0E94 0000 		call nrk_signal_create
 994 0198 8093 0000 		sts bmac_tx_pkt_done_signal,r24
 262:../../../src/net/bmac/rf231_soc/bmac.c ****   if (bmac_tx_pkt_done_signal == NRK_ERROR) {
 996               	.LM89:
 997 019c 8F3F      		cpi r24,lo8(-1)
 998 019e 01F4      		brne .L38
 263:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kprintf (PSTR ("BMAC ERROR: creating tx signal failed\r\n"));
 1000               	.LM90:
 1001 01a0 80E0      		ldi r24,lo8(__c.3591)
 1002 01a2 90E0      		ldi r25,hi8(__c.3591)
 1003               	.L40:
 1004 01a4 0E94 0000 		call nrk_kprintf
 264:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kernel_error_add (NRK_SIGNAL_CREATE_ERROR, nrk_cur_task_TCB->task_ID);
 1006               	.LM91:
 1007 01a8 E091 0000 		lds r30,nrk_cur_task_TCB
 1008 01ac F091 0000 		lds r31,nrk_cur_task_TCB+1
 1009 01b0 6085      		ldd r22,Z+8
 1010 01b2 8EE0      		ldi r24,lo8(14)
 1011 01b4 0E94 0000 		call nrk_kernel_error_add
 265:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 1013               	.LM92:
 1014 01b8 8FEF      		ldi r24,lo8(-1)
 1015 01ba 00C0      		rjmp .L37
 1016               	.L38:
 266:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 267:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_enable_signal = nrk_signal_create ();
 1018               	.LM93:
 1019 01bc 0E94 0000 		call nrk_signal_create
 1020 01c0 8093 0000 		sts bmac_enable_signal,r24
 268:../../../src/net/bmac/rf231_soc/bmac.c ****   if (bmac_enable_signal == NRK_ERROR) {
 1022               	.LM94:
 1023 01c4 8F3F      		cpi r24,lo8(-1)
 1024 01c6 01F4      		brne .L39
 269:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kprintf (PSTR ("BMAC ERROR: creating enable signal failed\r\n"));
 1026               	.LM95:
 1027 01c8 80E0      		ldi r24,lo8(__c.3593)
 1028 01ca 90E0      		ldi r25,hi8(__c.3593)
 1029 01cc 00C0      		rjmp .L40
 1030               	.L39:
 270:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kernel_error_add (NRK_SIGNAL_CREATE_ERROR, nrk_cur_task_TCB->task_ID);
 271:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 272:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 273:../../../src/net/bmac/rf231_soc/bmac.c **** 
 274:../../../src/net/bmac/rf231_soc/bmac.c **** 
 275:../../../src/net/bmac/rf231_soc/bmac.c ****   tx_data_ready = 0;
 1032               	.LM96:
 1033 01ce 1092 0000 		sts tx_data_ready,__zero_reg__
 276:../../../src/net/bmac/rf231_soc/bmac.c ****   // Set the one main rx buffer
 277:../../../src/net/bmac/rf231_soc/bmac.c ****   rx_buf_empty = 0;
 1035               	.LM97:
 1036 01d2 1092 0000 		sts rx_buf_empty,__zero_reg__
 278:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfRxInfo.pPayload = NULL;
 1038               	.LM98:
 1039 01d6 1092 0000 		sts bmac_rfRxInfo+5+1,__zero_reg__
 1040 01da 1092 0000 		sts bmac_rfRxInfo+5,__zero_reg__
 279:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfRxInfo.max_length = 0;
 1042               	.LM99:
 1043 01de 1092 0000 		sts bmac_rfRxInfo+4,__zero_reg__
 280:../../../src/net/bmac/rf231_soc/bmac.c **** 
 281:../../../src/net/bmac/rf231_soc/bmac.c ****   // Setup the cc2420 chip
 282:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_power_up ();
 1045               	.LM100:
 1046 01e2 0E94 0000 		call rf_power_up
 283:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_init (&bmac_rfRxInfo, chan, 0xffff, 0);
 1048               	.LM101:
 1049 01e6 20E0      		ldi r18,0
 1050 01e8 30E0      		ldi r19,0
 1051 01ea 4FEF      		ldi r20,lo8(-1)
 1052 01ec 5FEF      		ldi r21,lo8(-1)
 1053 01ee 6D2F      		mov r22,r29
 1054 01f0 80E0      		ldi r24,lo8(bmac_rfRxInfo)
 1055 01f2 90E0      		ldi r25,hi8(bmac_rfRxInfo)
 1056 01f4 0E94 0000 		call rf_init
 284:../../../src/net/bmac/rf231_soc/bmac.c ****   g_chan = chan;
 1058               	.LM102:
 1059 01f8 D093 0000 		sts g_chan,r29
 285:../../../src/net/bmac/rf231_soc/bmac.c **** 
 286:../../../src/net/bmac/rf231_soc/bmac.c **** //    FASTSPI_SETREG(CC2420_RSSI, 0xE580); // CCA THR=-25
 287:../../../src/net/bmac/rf231_soc/bmac.c **** //    FASTSPI_SETREG(CC2420_TXCTRL, 0x80FF); // TX TURNAROUND = 128 us
 288:../../../src/net/bmac/rf231_soc/bmac.c **** //    FASTSPI_SETREG(CC2420_RXCTRL1, 0x0A56); 
 289:../../../src/net/bmac/rf231_soc/bmac.c ****   // default cca thresh of -45
 290:../../../src/net/bmac/rf231_soc/bmac.c ****   //rf_set_cca_thresh(-45); 
 291:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_set_cca_thresh (0x0);
 1061               	.LM103:
 1062 01fc 80E0      		ldi r24,0
 1063 01fe 90E0      		ldi r25,0
 1064 0200 0E94 0000 		call rf_set_cca_thresh
 292:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_running = 1;
 1066               	.LM104:
 1067 0204 C093 0000 		sts bmac_running,r28
 293:../../../src/net/bmac/rf231_soc/bmac.c ****   is_enabled = 1;
 1069               	.LM105:
 1070 0208 C093 0000 		sts is_enabled,r28
 294:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 1072               	.LM106:
 1073 020c 81E0      		ldi r24,lo8(1)
 1074               	.L37:
 1075               	/* epilogue start */
 295:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1077               	.LM107:
 1078 020e DF91      		pop r29
 1079 0210 CF91      		pop r28
 1080 0212 0895      		ret
 1082               	.Lscope21:
 1084               		.stabd	78,0,0
 1088               	.global	bmac_tx_pkt_nonblocking
 1090               	bmac_tx_pkt_nonblocking:
 1091               		.stabd	46,0,0
 296:../../../src/net/bmac/rf231_soc/bmac.c **** 
 297:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_tx_pkt_nonblocking (uint8_t * buf, uint8_t len)
 298:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1093               	.LM108:
 1094               	.LFBB22:
 1095               	/* prologue: function */
 1096               	/* frame size = 0 */
 1097               	/* stack size = 0 */
 1098               	.L__stack_usage = 0
 299:../../../src/net/bmac/rf231_soc/bmac.c ****   if (tx_data_ready == 1)
 1100               	.LM109:
 1101 0214 2091 0000 		lds r18,tx_data_ready
 1102 0218 2130      		cpi r18,lo8(1)
 1103 021a 01F0      		breq .L43
 300:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 301:../../../src/net/bmac/rf231_soc/bmac.c ****   tx_data_ready = 1;
 1105               	.LM110:
 1106 021c 21E0      		ldi r18,lo8(1)
 1107 021e 2093 0000 		sts tx_data_ready,r18
 302:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.pPayload = buf;
 1109               	.LM111:
 1110 0222 9093 0000 		sts bmac_rfTxInfo+3+1,r25
 1111 0226 8093 0000 		sts bmac_rfTxInfo+3,r24
 303:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.length = len;
 1113               	.LM112:
 1114 022a 6093 0000 		sts bmac_rfTxInfo+2,r22
 304:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 1116               	.LM113:
 1117 022e 81E0      		ldi r24,lo8(1)
 1118 0230 0895      		ret
 1119               	.L43:
 300:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 1121               	.LM114:
 1122 0232 8FEF      		ldi r24,lo8(-1)
 305:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1124               	.LM115:
 1125 0234 0895      		ret
 1127               	.Lscope22:
 1129               		.stabd	78,0,0
 1131               	.global	bmac_get_rx_pkt_signal
 1133               	bmac_get_rx_pkt_signal:
 1134               		.stabd	46,0,0
 306:../../../src/net/bmac/rf231_soc/bmac.c **** 
 307:../../../src/net/bmac/rf231_soc/bmac.c **** nrk_sig_t bmac_get_rx_pkt_signal ()
 308:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1136               	.LM116:
 1137               	.LFBB23:
 1138               	/* prologue: function */
 1139               	/* frame size = 0 */
 1140               	/* stack size = 0 */
 1141               	.L__stack_usage = 0
 309:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_signal_register (bmac_rx_pkt_signal);
 1143               	.LM117:
 1144 0236 8091 0000 		lds r24,bmac_rx_pkt_signal
 1145 023a 0E94 0000 		call nrk_signal_register
 310:../../../src/net/bmac/rf231_soc/bmac.c ****   return (bmac_rx_pkt_signal);
 311:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1147               	.LM118:
 1148 023e 8091 0000 		lds r24,bmac_rx_pkt_signal
 1149 0242 0895      		ret
 1151               	.Lscope23:
 1153               		.stabd	78,0,0
 1155               	.global	bmac_get_tx_done_signal
 1157               	bmac_get_tx_done_signal:
 1158               		.stabd	46,0,0
 312:../../../src/net/bmac/rf231_soc/bmac.c **** 
 313:../../../src/net/bmac/rf231_soc/bmac.c **** nrk_sig_t bmac_get_tx_done_signal ()
 314:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1160               	.LM119:
 1161               	.LFBB24:
 1162               	/* prologue: function */
 1163               	/* frame size = 0 */
 1164               	/* stack size = 0 */
 1165               	.L__stack_usage = 0
 315:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_signal_register (bmac_tx_pkt_done_signal);
 1167               	.LM120:
 1168 0244 8091 0000 		lds r24,bmac_tx_pkt_done_signal
 1169 0248 0E94 0000 		call nrk_signal_register
 316:../../../src/net/bmac/rf231_soc/bmac.c ****   return (bmac_tx_pkt_done_signal);
 317:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1171               	.LM121:
 1172 024c 8091 0000 		lds r24,bmac_tx_pkt_done_signal
 1173 0250 0895      		ret
 1175               	.Lscope24:
 1177               		.stabd	78,0,0
 1181               	.global	bmac_tx_pkt
 1183               	bmac_tx_pkt:
 1184               		.stabd	46,0,0
 318:../../../src/net/bmac/rf231_soc/bmac.c **** 
 319:../../../src/net/bmac/rf231_soc/bmac.c **** 
 320:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_tx_pkt (uint8_t * buf, uint8_t len)
 321:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1186               	.LM122:
 1187               	.LFBB25:
 1188 0252 CF92      		push r12
 1189 0254 DF92      		push r13
 1190 0256 EF92      		push r14
 1191 0258 FF92      		push r15
 1192 025a CF93      		push r28
 1193 025c DF93      		push r29
 1194 025e 1F92      		push __zero_reg__
 1195 0260 CDB7      		in r28,__SP_L__
 1196 0262 DEB7      		in r29,__SP_H__
 1197               	/* prologue: function */
 1198               	/* frame size = 1 */
 1199               	/* stack size = 7 */
 1200               	.L__stack_usage = 7
 1201 0264 7C01      		movw r14,r24
 322:../../../src/net/bmac/rf231_soc/bmac.c ****   uint32_t mask;
 323:../../../src/net/bmac/rf231_soc/bmac.c ****   if (tx_data_ready == 1)
 1203               	.LM123:
 1204 0266 8091 0000 		lds r24,tx_data_ready
 1205 026a 8130      		cpi r24,lo8(1)
 1206 026c 01F0      		breq .L51
 324:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 325:../../../src/net/bmac/rf231_soc/bmac.c **** // If reserve exists check it
 326:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_MAX_RESERVES
 327:../../../src/net/bmac/rf231_soc/bmac.c ****   if (tx_reserve != -1) {
 328:../../../src/net/bmac/rf231_soc/bmac.c ****     if (nrk_reserve_consume (tx_reserve) == NRK_ERROR) {
 329:../../../src/net/bmac/rf231_soc/bmac.c ****       return NRK_ERROR;
 330:../../../src/net/bmac/rf231_soc/bmac.c ****     }
 331:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 332:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 333:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_signal_register (bmac_tx_pkt_done_signal);
 1208               	.LM124:
 1209 026e 8091 0000 		lds r24,bmac_tx_pkt_done_signal
 1210 0272 6983      		std Y+1,r22
 1211 0274 0E94 0000 		call nrk_signal_register
 334:../../../src/net/bmac/rf231_soc/bmac.c ****   tx_data_ready = 1;
 1213               	.LM125:
 1214 0278 81E0      		ldi r24,lo8(1)
 1215 027a 8093 0000 		sts tx_data_ready,r24
 335:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.pPayload = buf;
 1217               	.LM126:
 1218 027e F092 0000 		sts bmac_rfTxInfo+3+1,r15
 1219 0282 E092 0000 		sts bmac_rfTxInfo+3,r14
 336:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.length = len;
 1221               	.LM127:
 1222 0286 6981      		ldd r22,Y+1
 1223 0288 6093 0000 		sts bmac_rfTxInfo+2,r22
 337:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 338:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_kprintf (PSTR ("Waiting for tx done signal\r\n"));
 339:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 340:../../../src/net/bmac/rf231_soc/bmac.c ****   mask = nrk_event_wait (SIG (bmac_tx_pkt_done_signal));
 1225               	.LM128:
 1226 028c 61E0      		ldi r22,lo8(1)
 1227 028e 70E0      		ldi r23,0
 1228 0290 80E0      		ldi r24,0
 1229 0292 90E0      		ldi r25,0
 1230 0294 0090 0000 		lds r0,bmac_tx_pkt_done_signal
 1231 0298 00C0      		rjmp 2f
 1232               		1:
 1233 029a 660F      		lsl r22
 1234 029c 771F      		rol r23
 1235 029e 881F      		rol r24
 1236 02a0 991F      		rol r25
 1237               		2:
 1238 02a2 0A94      		dec r0
 1239 02a4 02F4      		brpl 1b
 1240 02a6 0E94 0000 		call nrk_event_wait
 1241 02aa 6B01      		movw r12,r22
 1242 02ac 7C01      		movw r14,r24
 341:../../../src/net/bmac/rf231_soc/bmac.c ****   if (mask == 0)
 1244               	.LM129:
 1245 02ae 6115      		cp r22,__zero_reg__
 1246 02b0 7105      		cpc r23,__zero_reg__
 1247 02b2 8105      		cpc r24,__zero_reg__
 1248 02b4 9105      		cpc r25,__zero_reg__
 1249 02b6 01F4      		brne .L48
 342:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kprintf (PSTR ("BMAC TX: Error calling event wait\r\n"));
 1251               	.LM130:
 1252 02b8 80E0      		ldi r24,lo8(__c.3609)
 1253 02ba 90E0      		ldi r25,hi8(__c.3609)
 1254 02bc 0E94 0000 		call nrk_kprintf
 1255               	.L48:
 343:../../../src/net/bmac/rf231_soc/bmac.c ****   if ((mask & SIG (bmac_tx_pkt_done_signal)) == 0)
 1257               	.LM131:
 1258 02c0 0090 0000 		lds r0,bmac_tx_pkt_done_signal
 1259 02c4 00C0      		rjmp 2f
 1260               		1:
 1261 02c6 F694      		lsr r15
 1262 02c8 E794      		ror r14
 1263 02ca D794      		ror r13
 1264 02cc C794      		ror r12
 1265               		2:
 1266 02ce 0A94      		dec r0
 1267 02d0 02F4      		brpl 1b
 1268 02d2 C0FC      		sbrc r12,0
 1269 02d4 00C0      		rjmp .L49
 344:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kprintf (PSTR ("BMAC TX: Woke up on wrong signal\r\n"));
 1271               	.LM132:
 1272 02d6 80E0      		ldi r24,lo8(__c.3611)
 1273 02d8 90E0      		ldi r25,hi8(__c.3611)
 1274 02da 0E94 0000 		call nrk_kprintf
 1275               	.L49:
 345:../../../src/net/bmac/rf231_soc/bmac.c ****   if (pkt_got_ack)
 1277               	.LM133:
 1278 02de 8091 0000 		lds r24,pkt_got_ack
 1279 02e2 8823      		tst r24
 1280 02e4 01F0      		breq .L51
 346:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_OK;
 1282               	.LM134:
 1283 02e6 81E0      		ldi r24,lo8(1)
 1284 02e8 00C0      		rjmp .L47
 1285               	.L51:
 347:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_ERROR;
 1287               	.LM135:
 1288 02ea 8FEF      		ldi r24,lo8(-1)
 1289               	.L47:
 1290               	/* epilogue start */
 348:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1292               	.LM136:
 1293 02ec 0F90      		pop __tmp_reg__
 1294 02ee DF91      		pop r29
 1295 02f0 CF91      		pop r28
 1296 02f2 FF90      		pop r15
 1297 02f4 EF90      		pop r14
 1298 02f6 DF90      		pop r13
 1299 02f8 CF90      		pop r12
 1300 02fa 0895      		ret
 1305               	.Lscope25:
 1307               		.stabd	78,0,0
 1311               	.global	bmac_rx_pkt_get
 1313               	bmac_rx_pkt_get:
 1314               		.stabd	46,0,0
 349:../../../src/net/bmac/rf231_soc/bmac.c **** 
 350:../../../src/net/bmac/rf231_soc/bmac.c **** 
 351:../../../src/net/bmac/rf231_soc/bmac.c **** uint8_t *bmac_rx_pkt_get (uint8_t * len, int8_t * rssi)
 352:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1316               	.LM137:
 1317               	.LFBB26:
 1318               	/* prologue: function */
 1319               	/* frame size = 0 */
 1320               	/* stack size = 0 */
 1321               	.L__stack_usage = 0
 353:../../../src/net/bmac/rf231_soc/bmac.c **** 
 354:../../../src/net/bmac/rf231_soc/bmac.c ****   if (bmac_rx_pkt_ready () == 0) {
 1323               	.LM138:
 1324 02fc 2091 0000 		lds r18,rx_buf_empty
 1325 0300 2223      		tst r18
 1326 0302 01F0      		breq .L53
 355:../../../src/net/bmac/rf231_soc/bmac.c ****     *len = 0;
 1328               	.LM139:
 1329 0304 FC01      		movw r30,r24
 1330 0306 1082      		st Z,__zero_reg__
 356:../../../src/net/bmac/rf231_soc/bmac.c ****     *rssi = 0;
 1332               	.LM140:
 1333 0308 FB01      		movw r30,r22
 1334 030a 1082      		st Z,__zero_reg__
 357:../../../src/net/bmac/rf231_soc/bmac.c ****     return NULL;
 1336               	.LM141:
 1337 030c 80E0      		ldi r24,0
 1338 030e 90E0      		ldi r25,0
 1339 0310 0895      		ret
 1340               	.L53:
 358:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 359:../../../src/net/bmac/rf231_soc/bmac.c ****   *len = bmac_rfRxInfo.length;
 1342               	.LM142:
 1343 0312 2091 0000 		lds r18,bmac_rfRxInfo+3
 1344 0316 FC01      		movw r30,r24
 1345 0318 2083      		st Z,r18
 360:../../../src/net/bmac/rf231_soc/bmac.c ****   *rssi = bmac_rfRxInfo.rssi;
 1347               	.LM143:
 1348 031a 8091 0000 		lds r24,bmac_rfRxInfo+8
 1349 031e FB01      		movw r30,r22
 1350 0320 8083      		st Z,r24
 361:../../../src/net/bmac/rf231_soc/bmac.c ****   return bmac_rfRxInfo.pPayload;
 1352               	.LM144:
 1353 0322 8091 0000 		lds r24,bmac_rfRxInfo+5
 1354 0326 9091 0000 		lds r25,bmac_rfRxInfo+5+1
 362:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1356               	.LM145:
 1357 032a 0895      		ret
 1359               	.Lscope26:
 1361               		.stabd	78,0,0
 1363               	.global	bmac_rx_pkt_ready
 1365               	bmac_rx_pkt_ready:
 1366               		.stabd	46,0,0
 363:../../../src/net/bmac/rf231_soc/bmac.c **** 
 364:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_rx_pkt_ready (void)
 365:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1368               	.LM146:
 1369               	.LFBB27:
 1370               	/* prologue: function */
 1371               	/* frame size = 0 */
 1372               	/* stack size = 0 */
 1373               	.L__stack_usage = 0
 366:../../../src/net/bmac/rf231_soc/bmac.c ****   return (!rx_buf_empty);
 1375               	.LM147:
 1376 032c 81E0      		ldi r24,lo8(1)
 1377 032e 9091 0000 		lds r25,rx_buf_empty
 1378 0332 9111      		cpse r25,__zero_reg__
 1379 0334 80E0      		ldi r24,0
 1380               	.L56:
 367:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1382               	.LM148:
 1383 0336 0895      		ret
 1385               	.Lscope27:
 1387               		.stabd	78,0,0
 1389               	.global	bmac_rx_pkt_release
 1391               	bmac_rx_pkt_release:
 1392               		.stabd	46,0,0
 368:../../../src/net/bmac/rf231_soc/bmac.c **** 
 369:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_rx_pkt_release (void)
 370:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1394               	.LM149:
 1395               	.LFBB28:
 1396               	/* prologue: function */
 1397               	/* frame size = 0 */
 1398               	/* stack size = 0 */
 1399               	.L__stack_usage = 0
 371:../../../src/net/bmac/rf231_soc/bmac.c ****   rx_buf_empty = 1;
 1401               	.LM150:
 1402 0338 81E0      		ldi r24,lo8(1)
 1403 033a 8093 0000 		sts rx_buf_empty,r24
 372:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 373:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1405               	.LM151:
 1406 033e 0895      		ret
 1408               	.Lscope28:
 1410               		.stabd	78,0,0
 1412               	.global	bmac_disable
 1414               	bmac_disable:
 1415               		.stabd	46,0,0
 374:../../../src/net/bmac/rf231_soc/bmac.c **** 
 375:../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_disable ()
 376:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1417               	.LM152:
 1418               	.LFBB29:
 1419               	/* prologue: function */
 1420               	/* frame size = 0 */
 1421               	/* stack size = 0 */
 1422               	.L__stack_usage = 0
 377:../../../src/net/bmac/rf231_soc/bmac.c ****   is_enabled = 0;
 1424               	.LM153:
 1425 0340 1092 0000 		sts is_enabled,__zero_reg__
 378:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_power_down ();
 1427               	.LM154:
 1428 0344 0C94 0000 		jmp rf_power_down
 1430               	.Lscope29:
 1432               		.stabd	78,0,0
 1434               	.global	bmac_enable
 1436               	bmac_enable:
 1437               		.stabd	46,0,0
 379:../../../src/net/bmac/rf231_soc/bmac.c **** }
 380:../../../src/net/bmac/rf231_soc/bmac.c **** 
 381:../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_enable ()
 382:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1439               	.LM155:
 1440               	.LFBB30:
 1441               	/* prologue: function */
 1442               	/* frame size = 0 */
 1443               	/* stack size = 0 */
 1444               	.L__stack_usage = 0
 383:../../../src/net/bmac/rf231_soc/bmac.c ****   is_enabled = 1;
 1446               	.LM156:
 1447 0348 81E0      		ldi r24,lo8(1)
 1448 034a 8093 0000 		sts is_enabled,r24
 384:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_power_up ();
 1450               	.LM157:
 1451 034e 0E94 0000 		call rf_power_up
 385:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_event_signal (bmac_enable_signal);
 1453               	.LM158:
 1454 0352 8091 0000 		lds r24,bmac_enable_signal
 1455 0356 0C94 0000 		jmp nrk_event_signal
 1457               	.Lscope30:
 1459               		.stabd	78,0,0
 1462               	.global	bmac_set_rx_check_rate
 1464               	bmac_set_rx_check_rate:
 1465               		.stabd	46,0,0
 386:../../../src/net/bmac/rf231_soc/bmac.c **** }
 387:../../../src/net/bmac/rf231_soc/bmac.c **** 
 388:../../../src/net/bmac/rf231_soc/bmac.c **** 
 389:../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_nw_task ()
 390:../../../src/net/bmac/rf231_soc/bmac.c **** {
 391:../../../src/net/bmac/rf231_soc/bmac.c ****   int8_t v, i;
 392:../../../src/net/bmac/rf231_soc/bmac.c ****   int8_t e;
 393:../../../src/net/bmac/rf231_soc/bmac.c ****   uint8_t backoff;
 394:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_sig_mask_t event;
 395:../../../src/net/bmac/rf231_soc/bmac.c **** 
 396:../../../src/net/bmac/rf231_soc/bmac.c ****   while (bmac_started () == 0)
 397:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_wait_until_next_period ();
 398:../../../src/net/bmac/rf231_soc/bmac.c **** 
 399:../../../src/net/bmac/rf231_soc/bmac.c **** //register the signal after bmac_init has been called
 400:../../../src/net/bmac/rf231_soc/bmac.c ****   v = nrk_signal_register (bmac_enable_signal);
 401:../../../src/net/bmac/rf231_soc/bmac.c ****   if (v == NRK_ERROR)
 402:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kprintf (PSTR ("Failed to register signal\r\n"));
 403:../../../src/net/bmac/rf231_soc/bmac.c ****   backoff = 0;
 404:../../../src/net/bmac/rf231_soc/bmac.c ****   while (1) {
 405:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef NRK_SW_WDT
 406:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef BMAC_SW_WDT_ID
 407:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_sw_wdt_update (BMAC_SW_WDT_ID);
 408:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 409:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 410:../../../src/net/bmac/rf231_soc/bmac.c ****     rf_power_up ();
 411:../../../src/net/bmac/rf231_soc/bmac.c ****     if (is_enabled) {
 412:../../../src/net/bmac/rf231_soc/bmac.c ****       v = 1;
 413:../../../src/net/bmac/rf231_soc/bmac.c **** 
 414:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef BMAC_MOD_CCA
 415:../../../src/net/bmac/rf231_soc/bmac.c ****       if (rx_buf_empty == 1)
 416:../../../src/net/bmac/rf231_soc/bmac.c ****       {
 417:../../../src/net/bmac/rf231_soc/bmac.c **** 	 if (_bmac_rx () == 1) e = nrk_event_signal (bmac_rx_pkt_signal);
 418:../../../src/net/bmac/rf231_soc/bmac.c ****       }
 419:../../../src/net/bmac/rf231_soc/bmac.c ****       else
 420:../../../src/net/bmac/rf231_soc/bmac.c ****       e = nrk_event_signal (bmac_rx_pkt_signal);
 421:../../../src/net/bmac/rf231_soc/bmac.c **** #else
 422:../../../src/net/bmac/rf231_soc/bmac.c ****       if (rx_buf_empty == 1)
 423:../../../src/net/bmac/rf231_soc/bmac.c ****         v = _bmac_channel_check ();
 424:../../../src/net/bmac/rf231_soc/bmac.c ****       // If the buffer is full, signal the receiving task again.
 425:../../../src/net/bmac/rf231_soc/bmac.c ****       else
 426:../../../src/net/bmac/rf231_soc/bmac.c ****         e = nrk_event_signal (bmac_rx_pkt_signal);
 427:../../../src/net/bmac/rf231_soc/bmac.c ****       // bmac_channel check turns on radio, don't turn off if
 428:../../../src/net/bmac/rf231_soc/bmac.c ****       // data is coming.
 429:../../../src/net/bmac/rf231_soc/bmac.c **** 
 430:../../../src/net/bmac/rf231_soc/bmac.c ****       if (v == 0) {
 431:../../../src/net/bmac/rf231_soc/bmac.c ****         if (_bmac_rx () == 1) {
 432:../../../src/net/bmac/rf231_soc/bmac.c ****           e = nrk_event_signal (bmac_rx_pkt_signal);
 433:../../../src/net/bmac/rf231_soc/bmac.c ****           //if(e==NRK_ERROR) {
 434:../../../src/net/bmac/rf231_soc/bmac.c ****           //      nrk_kprintf( PSTR("bmac rx pkt signal failed\r\n"));
 435:../../../src/net/bmac/rf231_soc/bmac.c ****           //      printf( "errno: %u \r\n",nrk_errno_get() );
 436:../../../src/net/bmac/rf231_soc/bmac.c ****           //}
 437:../../../src/net/bmac/rf231_soc/bmac.c ****         }
 438:../../../src/net/bmac/rf231_soc/bmac.c ****         //else nrk_kprintf( PSTR("Pkt failed, buf could be corrupt\r\n" ));
 439:../../../src/net/bmac/rf231_soc/bmac.c **** 
 440:../../../src/net/bmac/rf231_soc/bmac.c ****       }
 441:../../../src/net/bmac/rf231_soc/bmac.c **** 
 442:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 443:../../../src/net/bmac/rf231_soc/bmac.c ****       if (tx_data_ready == 1) {
 444:../../../src/net/bmac/rf231_soc/bmac.c ****         _bmac_tx ();
 445:../../../src/net/bmac/rf231_soc/bmac.c ****       }
 446:../../../src/net/bmac/rf231_soc/bmac.c ****       rf_rx_off ();
 447:../../../src/net/bmac/rf231_soc/bmac.c ****       rf_power_down ();
 448:../../../src/net/bmac/rf231_soc/bmac.c **** 
 449:../../../src/net/bmac/rf231_soc/bmac.c ****       //do {
 450:../../../src/net/bmac/rf231_soc/bmac.c ****       nrk_wait (_bmac_check_period);
 451:../../../src/net/bmac/rf231_soc/bmac.c ****       //      if(rx_buf_empty!=1)  nrk_event_signal (bmac_rx_pkt_signal);
 452:../../../src/net/bmac/rf231_soc/bmac.c ****       //} while(rx_buf_empty!=1);
 453:../../../src/net/bmac/rf231_soc/bmac.c ****     }
 454:../../../src/net/bmac/rf231_soc/bmac.c ****     else {
 455:../../../src/net/bmac/rf231_soc/bmac.c ****       event = 0;
 456:../../../src/net/bmac/rf231_soc/bmac.c ****       do {
 457:../../../src/net/bmac/rf231_soc/bmac.c ****         v = nrk_signal_register (bmac_enable_signal);
 458:../../../src/net/bmac/rf231_soc/bmac.c ****         event = nrk_event_wait (SIG (bmac_enable_signal));
 459:../../../src/net/bmac/rf231_soc/bmac.c ****       }
 460:../../../src/net/bmac/rf231_soc/bmac.c ****       while ((event & SIG (bmac_enable_signal)) == 0);
 461:../../../src/net/bmac/rf231_soc/bmac.c ****     }
 462:../../../src/net/bmac/rf231_soc/bmac.c ****     //nrk_wait_until_next_period();
 463:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 464:../../../src/net/bmac/rf231_soc/bmac.c **** 
 465:../../../src/net/bmac/rf231_soc/bmac.c **** }
 466:../../../src/net/bmac/rf231_soc/bmac.c **** 
 467:../../../src/net/bmac/rf231_soc/bmac.c **** 
 468:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_set_rx_check_rate (nrk_time_t period)
 469:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1467               	.LM159:
 1468               	.LFBB31:
 1469 035a CF93      		push r28
 1470 035c DF93      		push r29
 1471 035e CDB7      		in r28,__SP_L__
 1472 0360 DEB7      		in r29,__SP_H__
 1473 0362 2897      		sbiw r28,8
 1474 0364 0FB6      		in __tmp_reg__,__SREG__
 1475 0366 F894      		cli
 1476 0368 DEBF      		out __SP_H__,r29
 1477 036a 0FBE      		out __SREG__,__tmp_reg__
 1478 036c CDBF      		out __SP_L__,r28
 1479               	/* prologue: function */
 1480               	/* frame size = 8 */
 1481               	/* stack size = 10 */
 1482               	.L__stack_usage = 10
 1483 036e 2983      		std Y+1,r18
 1484 0370 3A83      		std Y+2,r19
 1485 0372 4B83      		std Y+3,r20
 1486 0374 5C83      		std Y+4,r21
 1487 0376 6D83      		std Y+5,r22
 1488 0378 7E83      		std Y+6,r23
 1489 037a 8F83      		std Y+7,r24
 1490 037c 9887      		std Y+8,r25
 1491 037e 4981      		ldd r20,Y+1
 1492 0380 5A81      		ldd r21,Y+2
 1493 0382 6B81      		ldd r22,Y+3
 1494 0384 7C81      		ldd r23,Y+4
 1495 0386 8D81      		ldd r24,Y+5
 1496 0388 9E81      		ldd r25,Y+6
 1497 038a AF81      		ldd r26,Y+7
 1498 038c B885      		ldd r27,Y+8
 470:../../../src/net/bmac/rf231_soc/bmac.c ****   if (period.secs == 0
 1500               	.LM160:
 1501 038e 4115      		cp r20,__zero_reg__
 1502 0390 5105      		cpc r21,__zero_reg__
 1503 0392 6105      		cpc r22,__zero_reg__
 1504 0394 7105      		cpc r23,__zero_reg__
 1505 0396 01F4      		brne .L64
 471:../../../src/net/bmac/rf231_soc/bmac.c ****       && period.nano_secs < BMAC_MIN_CHECK_RATE_MS * NANOS_PER_MS)
 1507               	.LM161:
 1508 0398 8115      		cp r24,__zero_reg__
 1509 039a 2DE2      		ldi r18,45
 1510 039c 9207      		cpc r25,r18
 1511 039e 21E3      		ldi r18,49
 1512 03a0 A207      		cpc r26,r18
 1513 03a2 21E0      		ldi r18,1
 1514 03a4 B207      		cpc r27,r18
 1515 03a6 00F0      		brlo .L66
 1516               	.L64:
 472:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 473:../../../src/net/bmac/rf231_soc/bmac.c ****   _bmac_check_period.secs = period.secs;
 1518               	.LM162:
 1519 03a8 4093 0000 		sts _bmac_check_period,r20
 1520 03ac 5093 0000 		sts _bmac_check_period+1,r21
 1521 03b0 6093 0000 		sts _bmac_check_period+2,r22
 1522 03b4 7093 0000 		sts _bmac_check_period+3,r23
 474:../../../src/net/bmac/rf231_soc/bmac.c ****   _bmac_check_period.nano_secs = period.nano_secs;
 1524               	.LM163:
 1525 03b8 8093 0000 		sts _bmac_check_period+4,r24
 1526 03bc 9093 0000 		sts _bmac_check_period+4+1,r25
 1527 03c0 A093 0000 		sts _bmac_check_period+4+2,r26
 1528 03c4 B093 0000 		sts _bmac_check_period+4+3,r27
 475:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 1530               	.LM164:
 1531 03c8 81E0      		ldi r24,lo8(1)
 1532 03ca 00C0      		rjmp .L65
 1533               	.L66:
 472:../../../src/net/bmac/rf231_soc/bmac.c ****     return NRK_ERROR;
 1535               	.LM165:
 1536 03cc 8FEF      		ldi r24,lo8(-1)
 1537               	.L65:
 1538               	/* epilogue start */
 476:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1540               	.LM166:
 1541 03ce 2896      		adiw r28,8
 1542 03d0 0FB6      		in __tmp_reg__,__SREG__
 1543 03d2 F894      		cli
 1544 03d4 DEBF      		out __SP_H__,r29
 1545 03d6 0FBE      		out __SREG__,__tmp_reg__
 1546 03d8 CDBF      		out __SP_L__,r28
 1547 03da DF91      		pop r29
 1548 03dc CF91      		pop r28
 1549 03de 0895      		ret
 1551               	.Lscope31:
 1553               		.stabd	78,0,0
 1555               	.global	bmac_started
 1557               	bmac_started:
 1558               		.stabd	46,0,0
 477:../../../src/net/bmac/rf231_soc/bmac.c **** 
 478:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t bmac_started ()
 479:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1560               	.LM167:
 1561               	.LFBB32:
 1562               	/* prologue: function */
 1563               	/* frame size = 0 */
 1564               	/* stack size = 0 */
 1565               	.L__stack_usage = 0
 480:../../../src/net/bmac/rf231_soc/bmac.c ****   return bmac_running;
 481:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1567               	.LM168:
 1568 03e0 8091 0000 		lds r24,bmac_running
 1569 03e4 0895      		ret
 1571               	.Lscope32:
 1573               		.stabd	78,0,0
 1575               	.global	_bmac_channel_check
 1577               	_bmac_channel_check:
 1578               		.stabd	46,0,0
 482:../../../src/net/bmac/rf231_soc/bmac.c **** 
 483:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t _bmac_channel_check ()
 484:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1580               	.LM169:
 1581               	.LFBB33:
 1582 03e6 CF93      		push r28
 1583               	/* prologue: function */
 1584               	/* frame size = 0 */
 1585               	/* stack size = 1 */
 1586               	.L__stack_usage = 1
 485:../../../src/net/bmac/rf231_soc/bmac.c ****   int8_t val = 0;
 486:../../../src/net/bmac/rf231_soc/bmac.c **** 
 487:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_on ();
 1588               	.LM170:
 1589 03e8 0E94 0000 		call rf_rx_on
 488:../../../src/net/bmac/rf231_soc/bmac.c ****   val += rf_cca_check ();
 1591               	.LM171:
 1592 03ec 0E94 0000 		call rf_cca_check
 1593 03f0 C82F      		mov r28,r24
 489:../../../src/net/bmac/rf231_soc/bmac.c ****   val += rf_cca_check ();
 1595               	.LM172:
 1596 03f2 0E94 0000 		call rf_cca_check
 1597 03f6 C80F      		add r28,r24
 490:../../../src/net/bmac/rf231_soc/bmac.c ****   val += rf_cca_check ();
 1599               	.LM173:
 1600 03f8 0E94 0000 		call rf_cca_check
 1601 03fc C80F      		add r28,r24
 491:../../../src/net/bmac/rf231_soc/bmac.c ****   if (val > 1)
 492:../../../src/net/bmac/rf231_soc/bmac.c ****     val = 1;
 493:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_off ();
 1603               	.LM174:
 1604 03fe 0E94 0000 		call rf_rx_off
 1605 0402 8C2F      		mov r24,r28
 1606 0404 1C16      		cp __zero_reg__,r28
 1607 0406 04F4      		brge .L69
 1608 0408 81E0      		ldi r24,lo8(1)
 1609               	.L69:
 1610               	/* epilogue start */
 494:../../../src/net/bmac/rf231_soc/bmac.c ****   return val;
 495:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1612               	.LM175:
 1613 040a CF91      		pop r28
 1614 040c 0895      		ret
 1616               	.Lscope33:
 1618               		.stabd	78,0,0
 1620               	.global	_bmac_rx
 1622               	_bmac_rx:
 1623               		.stabd	46,0,0
 496:../../../src/net/bmac/rf231_soc/bmac.c **** 
 497:../../../src/net/bmac/rf231_soc/bmac.c **** // Assuming that CCA returned 1 and a packet is on its way
 498:../../../src/net/bmac/rf231_soc/bmac.c **** // Receive the packet or timeout and error
 499:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t _bmac_rx ()
 500:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1625               	.LM176:
 1626               	.LFBB34:
 1627               	/* prologue: function */
 1628               	/* frame size = 0 */
 1629               	/* stack size = 0 */
 1630               	.L__stack_usage = 0
 501:../../../src/net/bmac/rf231_soc/bmac.c ****   int8_t n;
 502:../../../src/net/bmac/rf231_soc/bmac.c ****   uint8_t cnt;
 503:../../../src/net/bmac/rf231_soc/bmac.c **** 
 504:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_on ();
 1632               	.LM177:
 1633 040e 0E94 0000 		call rf_rx_on
 505:../../../src/net/bmac/rf231_soc/bmac.c ****   cnt = 0;
 506:../../../src/net/bmac/rf231_soc/bmac.c **** //printf( "calling rx\r\n" );
 507:../../../src/net/bmac/rf231_soc/bmac.c ****   dummy_t.secs = 0;
 1635               	.LM178:
 1636 0412 1092 0000 		sts dummy_t,__zero_reg__
 1637 0416 1092 0000 		sts dummy_t+1,__zero_reg__
 1638 041a 1092 0000 		sts dummy_t+2,__zero_reg__
 1639 041e 1092 0000 		sts dummy_t+3,__zero_reg__
 508:../../../src/net/bmac/rf231_soc/bmac.c ****   dummy_t.nano_secs = 5 * NANOS_PER_MS;
 1641               	.LM179:
 1642 0422 80E4      		ldi r24,lo8(64)
 1643 0424 682F      		mov r22,r24
 1644 0426 8093 0000 		sts dummy_t+4,r24
 1645 042a 8BE4      		ldi r24,lo8(75)
 1646 042c 8093 0000 		sts dummy_t+5,r24
 1647 0430 8CE4      		ldi r24,lo8(76)
 1648 0432 8093 0000 		sts dummy_t+6,r24
 1649 0436 1092 0000 		sts dummy_t+7,__zero_reg__
 509:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_wait (dummy_t);
 1651               	.LM180:
 1652 043a 20E0      		ldi r18,0
 1653 043c 3091 0000 		lds r19,dummy_t+1
 1654 0440 4091 0000 		lds r20,dummy_t+2
 1655 0444 5091 0000 		lds r21,dummy_t+3
 1656 0448 7BE4      		ldi r23,lo8(75)
 1657 044a 90E0      		ldi r25,0
 1658 044c 0E94 0000 		call nrk_wait
 510:../../../src/net/bmac/rf231_soc/bmac.c **** 
 511:../../../src/net/bmac/rf231_soc/bmac.c ****   n = rf_rx_packet_nonblock ();
 1660               	.LM181:
 1661 0450 0E94 0000 		call rf_rx_packet_nonblock
 512:../../../src/net/bmac/rf231_soc/bmac.c **** 
 513:../../../src/net/bmac/rf231_soc/bmac.c ****   if (n != NRK_OK) {
 1663               	.LM182:
 1664 0454 8130      		cpi r24,lo8(1)
 1665 0456 01F0      		breq .L71
 514:../../../src/net/bmac/rf231_soc/bmac.c ****     if (rx_failure_cnt < 65535)
 1667               	.LM183:
 1668 0458 8091 0000 		lds r24,rx_failure_cnt
 1669 045c 9091 0000 		lds r25,rx_failure_cnt+1
 1670 0460 A091 0000 		lds r26,rx_failure_cnt+2
 1671 0464 B091 0000 		lds r27,rx_failure_cnt+3
 1672 0468 8F3F      		cpi r24,-1
 1673 046a 2FEF      		ldi r18,-1
 1674 046c 9207      		cpc r25,r18
 1675 046e A105      		cpc r26,__zero_reg__
 1676 0470 B105      		cpc r27,__zero_reg__
 1677 0472 00F4      		brsh .L72
 515:../../../src/net/bmac/rf231_soc/bmac.c ****       rx_failure_cnt++;
 1679               	.LM184:
 1680 0474 0196      		adiw r24,1
 1681 0476 A11D      		adc r26,__zero_reg__
 1682 0478 B11D      		adc r27,__zero_reg__
 1683 047a 8093 0000 		sts rx_failure_cnt,r24
 1684 047e 9093 0000 		sts rx_failure_cnt+1,r25
 1685 0482 A093 0000 		sts rx_failure_cnt+2,r26
 1686 0486 B093 0000 		sts rx_failure_cnt+3,r27
 1687               	.L72:
 516:../../../src/net/bmac/rf231_soc/bmac.c ****     rf_rx_off ();
 1689               	.LM185:
 1690 048a 0E94 0000 		call rf_rx_off
 517:../../../src/net/bmac/rf231_soc/bmac.c ****     return 0;
 1692               	.LM186:
 1693 048e 80E0      		ldi r24,0
 1694 0490 0895      		ret
 1695               	.L71:
 518:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 519:../../../src/net/bmac/rf231_soc/bmac.c **** 
 520:../../../src/net/bmac/rf231_soc/bmac.c **** /*while ( rf_rx_packet_nonblock() != NRK_OK )
 521:../../../src/net/bmac/rf231_soc/bmac.c **** 	{
 522:../../../src/net/bmac/rf231_soc/bmac.c **** 	cnt++;
 523:../../../src/net/bmac/rf231_soc/bmac.c **** 	nrk_wait(_bmac_check_period);
 524:../../../src/net/bmac/rf231_soc/bmac.c **** 	if(cnt>2) { 
 525:../../../src/net/bmac/rf231_soc/bmac.c **** 			#ifdef DEBUG
 526:../../../src/net/bmac/rf231_soc/bmac.c **** 			printf( "rx timeout 1 %d\r\n",cnt );
 527:../../../src/net/bmac/rf231_soc/bmac.c **** 			#endif
 528:../../../src/net/bmac/rf231_soc/bmac.c **** 			if(rx_failure_cnt<65535) rx_failure_cnt++;
 529:../../../src/net/bmac/rf231_soc/bmac.c **** 			rf_rx_off();
 530:../../../src/net/bmac/rf231_soc/bmac.c **** 			return 0;
 531:../../../src/net/bmac/rf231_soc/bmac.c **** 			} 
 532:../../../src/net/bmac/rf231_soc/bmac.c **** 	}
 533:../../../src/net/bmac/rf231_soc/bmac.c **** */
 534:../../../src/net/bmac/rf231_soc/bmac.c **** 
 535:../../../src/net/bmac/rf231_soc/bmac.c **** 
 536:../../../src/net/bmac/rf231_soc/bmac.c ****   rx_buf_empty = 0;
 1697               	.LM187:
 1698 0492 1092 0000 		sts rx_buf_empty,__zero_reg__
 537:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 538:../../../src/net/bmac/rf231_soc/bmac.c ****   printf ("BMAC: SNR= %d [", bmac_rfRxInfo.rssi);
 539:../../../src/net/bmac/rf231_soc/bmac.c ****   for (uint8_t i = 0; i < bmac_rfRxInfo.length; i++)
 540:../../../src/net/bmac/rf231_soc/bmac.c ****     printf ("%c", bmac_rfRxInfo.pPayload[i]);
 541:../../../src/net/bmac/rf231_soc/bmac.c ****   printf ("]\r\n");
 542:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 543:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_off ();
 1700               	.LM188:
 1701 0496 0E94 0000 		call rf_rx_off
 544:../../../src/net/bmac/rf231_soc/bmac.c ****   return 1;
 1703               	.LM189:
 1704 049a 81E0      		ldi r24,lo8(1)
 545:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1706               	.LM190:
 1707 049c 0895      		ret
 1709               	.Lscope34:
 1711               		.stabd	78,0,0
 1713               	.global	bmac_rx_failure_count_get
 1715               	bmac_rx_failure_count_get:
 1716               		.stabd	46,0,0
 546:../../../src/net/bmac/rf231_soc/bmac.c **** 
 547:../../../src/net/bmac/rf231_soc/bmac.c **** 
 548:../../../src/net/bmac/rf231_soc/bmac.c **** uint16_t bmac_rx_failure_count_get ()
 549:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1718               	.LM191:
 1719               	.LFBB35:
 1720               	/* prologue: function */
 1721               	/* frame size = 0 */
 1722               	/* stack size = 0 */
 1723               	.L__stack_usage = 0
 550:../../../src/net/bmac/rf231_soc/bmac.c ****   return rx_failure_cnt;
 551:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1725               	.LM192:
 1726 049e 8091 0000 		lds r24,rx_failure_cnt
 1727 04a2 9091 0000 		lds r25,rx_failure_cnt+1
 1728 04a6 0895      		ret
 1730               	.Lscope35:
 1732               		.stabd	78,0,0
 1734               	.global	bmac_rx_failure_count_reset
 1736               	bmac_rx_failure_count_reset:
 1737               		.stabd	46,0,0
 552:../../../src/net/bmac/rf231_soc/bmac.c **** 
 553:../../../src/net/bmac/rf231_soc/bmac.c **** uint8_t bmac_rx_failure_count_reset ()
 554:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1739               	.LM193:
 1740               	.LFBB36:
 1741               	/* prologue: function */
 1742               	/* frame size = 0 */
 1743               	/* stack size = 0 */
 1744               	.L__stack_usage = 0
 555:../../../src/net/bmac/rf231_soc/bmac.c ****   rx_failure_cnt = 0;
 1746               	.LM194:
 1747 04a8 1092 0000 		sts rx_failure_cnt,__zero_reg__
 1748 04ac 1092 0000 		sts rx_failure_cnt+1,__zero_reg__
 1749 04b0 1092 0000 		sts rx_failure_cnt+2,__zero_reg__
 1750 04b4 1092 0000 		sts rx_failure_cnt+3,__zero_reg__
 556:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 557:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1752               	.LM195:
 1753 04b8 81E0      		ldi r24,lo8(1)
 1754 04ba 0895      		ret
 1756               	.Lscope36:
 1758               		.stabd	78,0,0
 1761               	.global	_b_pow
 1763               	_b_pow:
 1764               		.stabd	46,0,0
 558:../../../src/net/bmac/rf231_soc/bmac.c **** 
 559:../../../src/net/bmac/rf231_soc/bmac.c **** int8_t _bmac_tx ()
 560:../../../src/net/bmac/rf231_soc/bmac.c **** {
 561:../../../src/net/bmac/rf231_soc/bmac.c ****   uint8_t v, backoff, backoff_count;
 562:../../../src/net/bmac/rf231_soc/bmac.c ****   uint16_t b;
 563:../../../src/net/bmac/rf231_soc/bmac.c **** 
 564:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 565:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_kprintf (PSTR ("_bmac_tx()\r\n"));
 566:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 567:../../../src/net/bmac/rf231_soc/bmac.c ****   if (cca_active) {
 568:../../../src/net/bmac/rf231_soc/bmac.c **** 
 569:../../../src/net/bmac/rf231_soc/bmac.c **** // Add random time here to stop nodes from synchronizing with eachother
 570:../../../src/net/bmac/rf231_soc/bmac.c ****     b = _nrk_time_to_ticks (&_bmac_check_period);
 571:../../../src/net/bmac/rf231_soc/bmac.c ****     b = b / ((rand () % 10) + 1);
 572:../../../src/net/bmac/rf231_soc/bmac.c **** //printf( "waiting %d\r\n",b );
 573:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_wait_until_ticks (b);
 574:../../../src/net/bmac/rf231_soc/bmac.c **** //nrk_wait_ticks(b);
 575:../../../src/net/bmac/rf231_soc/bmac.c **** 
 576:../../../src/net/bmac/rf231_soc/bmac.c ****     backoff_count = 1;
 577:../../../src/net/bmac/rf231_soc/bmac.c ****     do {
 578:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef BMAC_MOD_CCA
 579:../../../src/net/bmac/rf231_soc/bmac.c **** 	v=_bmac_rx();
 580:../../../src/net/bmac/rf231_soc/bmac.c **** 	v=!v;
 581:../../../src/net/bmac/rf231_soc/bmac.c ****         if (v == 1) { 
 582:../../../src/net/bmac/rf231_soc/bmac.c **** 		break; 
 583:../../../src/net/bmac/rf231_soc/bmac.c **** 	}
 584:../../../src/net/bmac/rf231_soc/bmac.c ****         nrk_event_signal (bmac_rx_pkt_signal);
 585:../../../src/net/bmac/rf231_soc/bmac.c **** #else
 586:../../../src/net/bmac/rf231_soc/bmac.c ****       v = _bmac_channel_check ();
 587:../../../src/net/bmac/rf231_soc/bmac.c ****       if (v == 1)
 588:../../../src/net/bmac/rf231_soc/bmac.c ****         break;
 589:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 590:../../../src/net/bmac/rf231_soc/bmac.c ****       // Channel is busy
 591:../../../src/net/bmac/rf231_soc/bmac.c ****       backoff = rand () % (_b_pow (backoff_count));
 592:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 593:../../../src/net/bmac/rf231_soc/bmac.c ****       printf ("backoff %d\r\n", backoff);
 594:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 595:../../../src/net/bmac/rf231_soc/bmac.c **** //      printf( "backoff %d\r\n",backoff );
 596:../../../src/net/bmac/rf231_soc/bmac.c ****       nrk_wait_until_next_n_periods (backoff);
 597:../../../src/net/bmac/rf231_soc/bmac.c ****       backoff_count++;
 598:../../../src/net/bmac/rf231_soc/bmac.c ****       if (backoff_count > 6)
 599:../../../src/net/bmac/rf231_soc/bmac.c ****         backoff_count = 6;      // cap it at 64    
 600:../../../src/net/bmac/rf231_soc/bmac.c ****       b = _nrk_time_to_ticks (&_bmac_check_period);
 601:../../../src/net/bmac/rf231_soc/bmac.c ****       b = b / ((rand () % 10) + 1);
 602:../../../src/net/bmac/rf231_soc/bmac.c **** //      printf( "waiting %d\r\n",b );
 603:../../../src/net/bmac/rf231_soc/bmac.c ****       nrk_wait_until_ticks (b);
 604:../../../src/net/bmac/rf231_soc/bmac.c **** //      nrk_wait_ticks(b);
 605:../../../src/net/bmac/rf231_soc/bmac.c **** 
 606:../../../src/net/bmac/rf231_soc/bmac.c ****     }
 607:../../../src/net/bmac/rf231_soc/bmac.c ****     while (v == 0);
 608:../../../src/net/bmac/rf231_soc/bmac.c ****   }
 609:../../../src/net/bmac/rf231_soc/bmac.c **** 
 610:../../../src/net/bmac/rf231_soc/bmac.c ****   // send extended preamble
 611:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.cca = 0;
 612:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.ackRequest = 0;
 613:../../../src/net/bmac/rf231_soc/bmac.c **** 
 614:../../../src/net/bmac/rf231_soc/bmac.c ****   uint16_t ms = _bmac_check_period.secs * 1000;
 615:../../../src/net/bmac/rf231_soc/bmac.c ****   ms += _bmac_check_period.nano_secs / 1000000;
 616:../../../src/net/bmac/rf231_soc/bmac.c ****   //printf( "CR ms: %u\n",ms );
 617:../../../src/net/bmac/rf231_soc/bmac.c ****   //target_t.nano_secs+=20*NANOS_PER_MS;
 618:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_on ();
 619:../../../src/net/bmac/rf231_soc/bmac.c ****   pkt_got_ack = rf_tx_packet_repeat (&bmac_rfTxInfo, ms);
 620:../../../src/net/bmac/rf231_soc/bmac.c **** 
 621:../../../src/net/bmac/rf231_soc/bmac.c ****   // send packet
 622:../../../src/net/bmac/rf231_soc/bmac.c ****   // pkt_got_ack=rf_tx_packet (&bmac_rfTxInfo);
 623:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_off ();                 // Just in case auto-ack left radio on
 624:../../../src/net/bmac/rf231_soc/bmac.c ****   tx_data_ready = 0;
 625:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_event_signal (bmac_tx_pkt_done_signal);
 626:../../../src/net/bmac/rf231_soc/bmac.c ****   return NRK_OK;
 627:../../../src/net/bmac/rf231_soc/bmac.c **** }
 628:../../../src/net/bmac/rf231_soc/bmac.c **** 
 629:../../../src/net/bmac/rf231_soc/bmac.c **** uint8_t _b_pow (uint8_t in)
 630:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1766               	.LM196:
 1767               	.LFBB37:
 1768               	/* prologue: function */
 1769               	/* frame size = 0 */
 1770               	/* stack size = 0 */
 1771               	.L__stack_usage = 0
 631:../../../src/net/bmac/rf231_soc/bmac.c ****   uint8_t i;
 632:../../../src/net/bmac/rf231_soc/bmac.c ****   uint8_t result;
 633:../../../src/net/bmac/rf231_soc/bmac.c ****   if (in <= 1)
 1773               	.LM197:
 1774 04bc 8230      		cpi r24,lo8(2)
 1775 04be 00F0      		brlo .L80
 634:../../../src/net/bmac/rf231_soc/bmac.c ****     return 1;
 635:../../../src/net/bmac/rf231_soc/bmac.c ****   if (in > 7)
 1777               	.LM198:
 1778 04c0 8830      		cpi r24,lo8(8)
 1779 04c2 00F0      		brlo .L78
 636:../../../src/net/bmac/rf231_soc/bmac.c ****     in = 6;                     // cap it at 128 
 1781               	.LM199:
 1782 04c4 86E0      		ldi r24,lo8(6)
 1783               	.L78:
 637:../../../src/net/bmac/rf231_soc/bmac.c ****   result = 1;
 1785               	.LM200:
 1786 04c6 91E0      		ldi r25,lo8(1)
 638:../../../src/net/bmac/rf231_soc/bmac.c ****   for (i = 0; i < in; i++)
 1788               	.LM201:
 1789 04c8 20E0      		ldi r18,0
 1790               	.L79:
 639:../../../src/net/bmac/rf231_soc/bmac.c ****     result = result * 2;
 1792               	.LM202:
 1793 04ca 990F      		lsl r25
 638:../../../src/net/bmac/rf231_soc/bmac.c ****   for (i = 0; i < in; i++)
 1795               	.LM203:
 1796 04cc 2F5F      		subi r18,lo8(-(1))
 1797 04ce 2817      		cp r18,r24
 1798 04d0 00F0      		brlo .L79
 1799 04d2 00C0      		rjmp .L83
 1800               	.L80:
 634:../../../src/net/bmac/rf231_soc/bmac.c ****     return 1;
 1802               	.LM204:
 1803 04d4 81E0      		ldi r24,lo8(1)
 1804 04d6 0895      		ret
 1805               	.L83:
 1807               	.LM205:
 1808 04d8 892F      		mov r24,r25
 640:../../../src/net/bmac/rf231_soc/bmac.c ****   return result;
 641:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1810               	.LM206:
 1811 04da 0895      		ret
 1817               	.Lscope37:
 1819               		.stabd	78,0,0
 1821               	.global	_bmac_tx
 1823               	_bmac_tx:
 1824               		.stabd	46,0,0
 560:../../../src/net/bmac/rf231_soc/bmac.c **** {
 1826               	.LM207:
 1827               	.LFBB38:
 1828 04dc EF92      		push r14
 1829 04de FF92      		push r15
 1830 04e0 0F93      		push r16
 1831 04e2 1F93      		push r17
 1832 04e4 CF93      		push r28
 1833 04e6 DF93      		push r29
 1834               	/* prologue: function */
 1835               	/* frame size = 0 */
 1836               	/* stack size = 6 */
 1837               	.L__stack_usage = 6
 567:../../../src/net/bmac/rf231_soc/bmac.c ****   if (cca_active) {
 1839               	.LM208:
 1840 04e8 8091 0000 		lds r24,cca_active
 1841 04ec 8823      		tst r24
 1842 04ee 01F4      		brne .+2
 1843 04f0 00C0      		rjmp .L86
 570:../../../src/net/bmac/rf231_soc/bmac.c ****     b = _nrk_time_to_ticks (&_bmac_check_period);
 1845               	.LM209:
 1846 04f2 80E0      		ldi r24,lo8(_bmac_check_period)
 1847 04f4 90E0      		ldi r25,hi8(_bmac_check_period)
 1848 04f6 0E94 0000 		call _nrk_time_to_ticks
 1849 04fa EC01      		movw r28,r24
 571:../../../src/net/bmac/rf231_soc/bmac.c ****     b = b / ((rand () % 10) + 1);
 1851               	.LM210:
 1852 04fc 0E94 0000 		call rand
 1853 0500 6AE0      		ldi r22,lo8(10)
 1854 0502 70E0      		ldi r23,0
 1855 0504 0E94 0000 		call __divmodhi4
 1856 0508 BC01      		movw r22,r24
 1857 050a 6F5F      		subi r22,-1
 1858 050c 7F4F      		sbci r23,-1
 1859 050e CE01      		movw r24,r28
 1860 0510 0E94 0000 		call __udivmodhi4
 1861 0514 CB01      		movw r24,r22
 573:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_wait_until_ticks (b);
 1863               	.LM211:
 1864 0516 0E94 0000 		call nrk_wait_until_ticks
 576:../../../src/net/bmac/rf231_soc/bmac.c ****     backoff_count = 1;
 1866               	.LM212:
 1867 051a FF24      		clr r15
 1868 051c F394      		inc r15
 601:../../../src/net/bmac/rf231_soc/bmac.c ****       b = b / ((rand () % 10) + 1);
 1870               	.LM213:
 1871 051e CAE0      		ldi r28,lo8(10)
 1872 0520 D0E0      		ldi r29,0
 1873               	.L88:
 586:../../../src/net/bmac/rf231_soc/bmac.c ****       v = _bmac_channel_check ();
 1875               	.LM214:
 1876 0522 0E94 0000 		call _bmac_channel_check
 1877 0526 E82E      		mov r14,r24
 587:../../../src/net/bmac/rf231_soc/bmac.c ****       if (v == 1)
 1879               	.LM215:
 1880 0528 81E0      		ldi r24,lo8(1)
 1881 052a E816      		cp r14,r24
 1882 052c 01F0      		breq .L86
 591:../../../src/net/bmac/rf231_soc/bmac.c ****       backoff = rand () % (_b_pow (backoff_count));
 1884               	.LM216:
 1885 052e 0E94 0000 		call rand
 1886 0532 8C01      		movw r16,r24
 1887 0534 8F2D      		mov r24,r15
 1888 0536 0E94 0000 		call _b_pow
 1889 053a 682F      		mov r22,r24
 1890 053c 70E0      		ldi r23,0
 1891 053e C801      		movw r24,r16
 1892 0540 0E94 0000 		call __divmodhi4
 596:../../../src/net/bmac/rf231_soc/bmac.c ****       nrk_wait_until_next_n_periods (backoff);
 1894               	.LM217:
 1895 0544 9927      		clr r25
 1896 0546 0E94 0000 		call nrk_wait_until_next_n_periods
 597:../../../src/net/bmac/rf231_soc/bmac.c ****       backoff_count++;
 1898               	.LM218:
 1899 054a F394      		inc r15
 1900 054c 86E0      		ldi r24,lo8(6)
 1901 054e 8F15      		cp r24,r15
 1902 0550 00F4      		brsh .L87
 1903 0552 86E0      		ldi r24,lo8(6)
 1904 0554 F82E      		mov r15,r24
 1905               	.L87:
 600:../../../src/net/bmac/rf231_soc/bmac.c ****       b = _nrk_time_to_ticks (&_bmac_check_period);
 1907               	.LM219:
 1908 0556 80E0      		ldi r24,lo8(_bmac_check_period)
 1909 0558 90E0      		ldi r25,hi8(_bmac_check_period)
 1910 055a 0E94 0000 		call _nrk_time_to_ticks
 1911 055e 8C01      		movw r16,r24
 601:../../../src/net/bmac/rf231_soc/bmac.c ****       b = b / ((rand () % 10) + 1);
 1913               	.LM220:
 1914 0560 0E94 0000 		call rand
 1915 0564 BE01      		movw r22,r28
 1916 0566 0E94 0000 		call __divmodhi4
 1917 056a BC01      		movw r22,r24
 1918 056c 6F5F      		subi r22,-1
 1919 056e 7F4F      		sbci r23,-1
 1920 0570 C801      		movw r24,r16
 1921 0572 0E94 0000 		call __udivmodhi4
 603:../../../src/net/bmac/rf231_soc/bmac.c ****       nrk_wait_until_ticks (b);
 1923               	.LM221:
 1924 0576 CB01      		movw r24,r22
 1925 0578 0E94 0000 		call nrk_wait_until_ticks
 607:../../../src/net/bmac/rf231_soc/bmac.c ****     while (v == 0);
 1927               	.LM222:
 1928 057c EE20      		tst r14
 1929 057e 01F0      		breq .L88
 1930               	.L86:
 611:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.cca = 0;
 1932               	.LM223:
 1933 0580 1092 0000 		sts bmac_rfTxInfo+5,__zero_reg__
 612:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_rfTxInfo.ackRequest = 0;
 1935               	.LM224:
 1936 0584 1092 0000 		sts bmac_rfTxInfo+6,__zero_reg__
 614:../../../src/net/bmac/rf231_soc/bmac.c ****   uint16_t ms = _bmac_check_period.secs * 1000;
 1938               	.LM225:
 1939 0588 2091 0000 		lds r18,_bmac_check_period
 1940 058c 3091 0000 		lds r19,_bmac_check_period+1
 1941 0590 88EE      		ldi r24,lo8(-24)
 1942 0592 93E0      		ldi r25,lo8(3)
 1943 0594 289F      		mul r18,r24
 1944 0596 E001      		movw r28,r0
 1945 0598 299F      		mul r18,r25
 1946 059a D00D      		add r29,r0
 1947 059c 389F      		mul r19,r24
 1948 059e D00D      		add r29,r0
 1949 05a0 1124      		clr r1
 615:../../../src/net/bmac/rf231_soc/bmac.c ****   ms += _bmac_check_period.nano_secs / 1000000;
 1951               	.LM226:
 1952 05a2 6091 0000 		lds r22,_bmac_check_period+4
 1953 05a6 7091 0000 		lds r23,_bmac_check_period+4+1
 1954 05aa 8091 0000 		lds r24,_bmac_check_period+4+2
 1955 05ae 9091 0000 		lds r25,_bmac_check_period+4+3
 1956 05b2 20E4      		ldi r18,lo8(64)
 1957 05b4 32E4      		ldi r19,lo8(66)
 1958 05b6 4FE0      		ldi r20,lo8(15)
 1959 05b8 50E0      		ldi r21,0
 1960 05ba 0E94 0000 		call __udivmodsi4
 1961 05be C20F      		add r28,r18
 1962 05c0 D31F      		adc r29,r19
 618:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_on ();
 1964               	.LM227:
 1965 05c2 0E94 0000 		call rf_rx_on
 619:../../../src/net/bmac/rf231_soc/bmac.c ****   pkt_got_ack = rf_tx_packet_repeat (&bmac_rfTxInfo, ms);
 1967               	.LM228:
 1968 05c6 BE01      		movw r22,r28
 1969 05c8 80E0      		ldi r24,lo8(bmac_rfTxInfo)
 1970 05ca 90E0      		ldi r25,hi8(bmac_rfTxInfo)
 1971 05cc 0E94 0000 		call rf_tx_packet_repeat
 1972 05d0 8093 0000 		sts pkt_got_ack,r24
 623:../../../src/net/bmac/rf231_soc/bmac.c ****   rf_rx_off ();                 // Just in case auto-ack left radio on
 1974               	.LM229:
 1975 05d4 0E94 0000 		call rf_rx_off
 624:../../../src/net/bmac/rf231_soc/bmac.c ****   tx_data_ready = 0;
 1977               	.LM230:
 1978 05d8 1092 0000 		sts tx_data_ready,__zero_reg__
 625:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_event_signal (bmac_tx_pkt_done_signal);
 1980               	.LM231:
 1981 05dc 8091 0000 		lds r24,bmac_tx_pkt_done_signal
 1982 05e0 0E94 0000 		call nrk_event_signal
 627:../../../src/net/bmac/rf231_soc/bmac.c **** }
 1984               	.LM232:
 1985 05e4 81E0      		ldi r24,lo8(1)
 1986               	/* epilogue start */
 1987 05e6 DF91      		pop r29
 1988 05e8 CF91      		pop r28
 1989 05ea 1F91      		pop r17
 1990 05ec 0F91      		pop r16
 1991 05ee FF90      		pop r15
 1992 05f0 EF90      		pop r14
 1993 05f2 0895      		ret
 1998               	.Lscope38:
 2000               		.stabd	78,0,0
 2002               	.global	bmac_nw_task
 2004               	bmac_nw_task:
 2005               		.stabd	46,0,0
 390:../../../src/net/bmac/rf231_soc/bmac.c **** {
 2007               	.LM233:
 2008               	.LFBB39:
 2009               	/* prologue: function */
 2010               	/* frame size = 0 */
 2011               	/* stack size = 0 */
 2012               	.L__stack_usage = 0
 2013               	.L94:
 396:../../../src/net/bmac/rf231_soc/bmac.c ****   while (bmac_started () == 0)
 2015               	.LM234:
 2016 05f4 8091 0000 		lds r24,bmac_running
 2017 05f8 8111      		cpse r24,__zero_reg__
 2018 05fa 00C0      		rjmp .L110
 397:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_wait_until_next_period ();
 2020               	.LM235:
 2021 05fc 0E94 0000 		call nrk_wait_until_next_period
 2022 0600 00C0      		rjmp .L94
 2023               	.L110:
 400:../../../src/net/bmac/rf231_soc/bmac.c ****   v = nrk_signal_register (bmac_enable_signal);
 2025               	.LM236:
 2026 0602 8091 0000 		lds r24,bmac_enable_signal
 2027 0606 0E94 0000 		call nrk_signal_register
 401:../../../src/net/bmac/rf231_soc/bmac.c ****   if (v == NRK_ERROR)
 2029               	.LM237:
 2030 060a 8F3F      		cpi r24,lo8(-1)
 2031 060c 01F4      		brne .L97
 402:../../../src/net/bmac/rf231_soc/bmac.c ****     nrk_kprintf (PSTR ("Failed to register signal\r\n"));
 2033               	.LM238:
 2034 060e 80E0      		ldi r24,lo8(__c.3637)
 2035 0610 90E0      		ldi r25,hi8(__c.3637)
 2036 0612 0E94 0000 		call nrk_kprintf
 2037               	.L97:
 458:../../../src/net/bmac/rf231_soc/bmac.c ****         event = nrk_event_wait (SIG (bmac_enable_signal));
 2039               	.LM239:
 2040 0616 C12C      		mov r12,__zero_reg__
 2041 0618 D12C      		mov r13,__zero_reg__
 2042 061a 7601      		movw r14,r12
 2043 061c C394      		inc r12
 2044               	.L104:
 410:../../../src/net/bmac/rf231_soc/bmac.c ****     rf_power_up ();
 2046               	.LM240:
 2047 061e 0E94 0000 		call rf_power_up
 411:../../../src/net/bmac/rf231_soc/bmac.c ****     if (is_enabled) {
 2049               	.LM241:
 2050 0622 8091 0000 		lds r24,is_enabled
 2051 0626 8823      		tst r24
 2052 0628 01F0      		breq .L106
 422:../../../src/net/bmac/rf231_soc/bmac.c ****       if (rx_buf_empty == 1)
 2054               	.LM242:
 2055 062a 8091 0000 		lds r24,rx_buf_empty
 2056 062e 8130      		cpi r24,lo8(1)
 2057 0630 01F4      		brne .L109
 423:../../../src/net/bmac/rf231_soc/bmac.c ****         v = _bmac_channel_check ();
 2059               	.LM243:
 2060 0632 0E94 0000 		call _bmac_channel_check
 430:../../../src/net/bmac/rf231_soc/bmac.c ****       if (v == 0) {
 2062               	.LM244:
 2063 0636 8111      		cpse r24,__zero_reg__
 2064 0638 00C0      		rjmp .L101
 431:../../../src/net/bmac/rf231_soc/bmac.c ****         if (_bmac_rx () == 1) {
 2066               	.LM245:
 2067 063a 0E94 0000 		call _bmac_rx
 2068 063e 8130      		cpi r24,lo8(1)
 2069 0640 01F4      		brne .L101
 2070               	.L109:
 432:../../../src/net/bmac/rf231_soc/bmac.c ****           e = nrk_event_signal (bmac_rx_pkt_signal);
 2072               	.LM246:
 2073 0642 8091 0000 		lds r24,bmac_rx_pkt_signal
 2074 0646 0E94 0000 		call nrk_event_signal
 2075               	.L101:
 443:../../../src/net/bmac/rf231_soc/bmac.c ****       if (tx_data_ready == 1) {
 2077               	.LM247:
 2078 064a 8091 0000 		lds r24,tx_data_ready
 2079 064e 8130      		cpi r24,lo8(1)
 2080 0650 01F4      		brne .L103
 444:../../../src/net/bmac/rf231_soc/bmac.c ****         _bmac_tx ();
 2082               	.LM248:
 2083 0652 0E94 0000 		call _bmac_tx
 2084               	.L103:
 446:../../../src/net/bmac/rf231_soc/bmac.c ****       rf_rx_off ();
 2086               	.LM249:
 2087 0656 0E94 0000 		call rf_rx_off
 447:../../../src/net/bmac/rf231_soc/bmac.c ****       rf_power_down ();
 2089               	.LM250:
 2090 065a 0E94 0000 		call rf_power_down
 450:../../../src/net/bmac/rf231_soc/bmac.c ****       nrk_wait (_bmac_check_period);
 2092               	.LM251:
 2093 065e 2091 0000 		lds r18,_bmac_check_period
 2094 0662 3091 0000 		lds r19,_bmac_check_period+1
 2095 0666 4091 0000 		lds r20,_bmac_check_period+2
 2096 066a 5091 0000 		lds r21,_bmac_check_period+3
 2097 066e 6091 0000 		lds r22,_bmac_check_period+4
 2098 0672 7091 0000 		lds r23,_bmac_check_period+5
 2099 0676 8091 0000 		lds r24,_bmac_check_period+6
 2100 067a 9091 0000 		lds r25,_bmac_check_period+7
 2101 067e 0E94 0000 		call nrk_wait
 2102 0682 00C0      		rjmp .L104
 2103               	.L106:
 457:../../../src/net/bmac/rf231_soc/bmac.c ****         v = nrk_signal_register (bmac_enable_signal);
 2105               	.LM252:
 2106 0684 8091 0000 		lds r24,bmac_enable_signal
 2107 0688 0E94 0000 		call nrk_signal_register
 458:../../../src/net/bmac/rf231_soc/bmac.c ****         event = nrk_event_wait (SIG (bmac_enable_signal));
 2109               	.LM253:
 2110 068c C701      		movw r24,r14
 2111 068e B601      		movw r22,r12
 2112 0690 0090 0000 		lds r0,bmac_enable_signal
 2113 0694 00C0      		rjmp 2f
 2114               		1:
 2115 0696 660F      		lsl r22
 2116 0698 771F      		rol r23
 2117 069a 881F      		rol r24
 2118 069c 991F      		rol r25
 2119               		2:
 2120 069e 0A94      		dec r0
 2121 06a0 02F4      		brpl 1b
 2122 06a2 0E94 0000 		call nrk_event_wait
 460:../../../src/net/bmac/rf231_soc/bmac.c ****       while ((event & SIG (bmac_enable_signal)) == 0);
 2124               	.LM254:
 2125 06a6 0090 0000 		lds r0,bmac_enable_signal
 2126 06aa 00C0      		rjmp 2f
 2127               		1:
 2128 06ac 9695      		lsr r25
 2129 06ae 8795      		ror r24
 2130 06b0 7795      		ror r23
 2131 06b2 6795      		ror r22
 2132               		2:
 2133 06b4 0A94      		dec r0
 2134 06b6 02F4      		brpl 1b
 2135 06b8 60FF      		sbrs r22,0
 2136 06ba 00C0      		rjmp .L106
 2137 06bc 00C0      		rjmp .L104
 2139               	.Lscope39:
 2141               		.stabd	78,0,0
 2143               	.global	bmac_task_config
 2145               	bmac_task_config:
 2146               		.stabd	46,0,0
 642:../../../src/net/bmac/rf231_soc/bmac.c **** 
 643:../../../src/net/bmac/rf231_soc/bmac.c **** 
 644:../../../src/net/bmac/rf231_soc/bmac.c **** void bmac_task_config ()
 645:../../../src/net/bmac/rf231_soc/bmac.c **** {
 2148               	.LM255:
 2149               	.LFBB40:
 2150               	/* prologue: function */
 2151               	/* frame size = 0 */
 2152               	/* stack size = 0 */
 2153               	.L__stack_usage = 0
 646:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_task_set_entry_function (&bmac_task, bmac_nw_task);
 2155               	.LM256:
 2156 06be 60E0      		ldi r22,lo8(gs(bmac_nw_task))
 2157 06c0 70E0      		ldi r23,hi8(gs(bmac_nw_task))
 2158 06c2 80E0      		ldi r24,lo8(bmac_task)
 2159 06c4 90E0      		ldi r25,hi8(bmac_task)
 2160 06c6 0E94 0000 		call nrk_task_set_entry_function
 647:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_task_set_stk (&bmac_task, bmac_task_stack, BMAC_STACKSIZE);
 2162               	.LM257:
 2163 06ca 40E0      		ldi r20,0
 2164 06cc 51E0      		ldi r21,lo8(1)
 2165 06ce 60E0      		ldi r22,lo8(bmac_task_stack)
 2166 06d0 70E0      		ldi r23,hi8(bmac_task_stack)
 2167 06d2 80E0      		ldi r24,lo8(bmac_task)
 2168 06d4 90E0      		ldi r25,hi8(bmac_task)
 2169 06d6 0E94 0000 		call nrk_task_set_stk
 648:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.prio = BMAC_TASK_PRIORITY;
 2171               	.LM258:
 2172 06da 84E1      		ldi r24,lo8(20)
 2173 06dc 8093 0000 		sts bmac_task+8,r24
 649:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.FirstActivation = TRUE;
 2175               	.LM259:
 2176 06e0 81E0      		ldi r24,lo8(1)
 2177 06e2 8093 0000 		sts bmac_task+7,r24
 650:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.Type = BASIC_TASK;
 2179               	.LM260:
 2180 06e6 8093 0000 		sts bmac_task+9,r24
 651:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.SchType = PREEMPTIVE;
 2182               	.LM261:
 2183 06ea 8093 0000 		sts bmac_task+10,r24
 652:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.period.secs = 0;
 2185               	.LM262:
 2186 06ee 1092 0000 		sts bmac_task+11,__zero_reg__
 2187 06f2 1092 0000 		sts bmac_task+11+1,__zero_reg__
 2188 06f6 1092 0000 		sts bmac_task+11+2,__zero_reg__
 2189 06fa 1092 0000 		sts bmac_task+11+3,__zero_reg__
 653:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.period.nano_secs = BMAC_MIN_CHECK_RATE_MS * NANOS_PER_MS;
 2191               	.LM263:
 2192 06fe 80E0      		ldi r24,0
 2193 0700 9DE2      		ldi r25,lo8(45)
 2194 0702 A1E3      		ldi r26,lo8(49)
 2195 0704 B1E0      		ldi r27,lo8(1)
 2196 0706 8093 0000 		sts bmac_task+15,r24
 2197 070a 9093 0000 		sts bmac_task+15+1,r25
 2198 070e A093 0000 		sts bmac_task+15+2,r26
 2199 0712 B093 0000 		sts bmac_task+15+3,r27
 654:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.cpu_reserve.secs = 0;       // bmac reserve , 0 to disable
 2201               	.LM264:
 2202 0716 1092 0000 		sts bmac_task+19,__zero_reg__
 2203 071a 1092 0000 		sts bmac_task+19+1,__zero_reg__
 2204 071e 1092 0000 		sts bmac_task+19+2,__zero_reg__
 2205 0722 1092 0000 		sts bmac_task+19+3,__zero_reg__
 655:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.cpu_reserve.nano_secs = 0;
 2207               	.LM265:
 2208 0726 1092 0000 		sts bmac_task+23,__zero_reg__
 2209 072a 1092 0000 		sts bmac_task+23+1,__zero_reg__
 2210 072e 1092 0000 		sts bmac_task+23+2,__zero_reg__
 2211 0732 1092 0000 		sts bmac_task+23+3,__zero_reg__
 656:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.offset.secs = 0;
 2213               	.LM266:
 2214 0736 1092 0000 		sts bmac_task+27,__zero_reg__
 2215 073a 1092 0000 		sts bmac_task+27+1,__zero_reg__
 2216 073e 1092 0000 		sts bmac_task+27+2,__zero_reg__
 2217 0742 1092 0000 		sts bmac_task+27+3,__zero_reg__
 657:../../../src/net/bmac/rf231_soc/bmac.c ****   bmac_task.offset.nano_secs = 0;
 2219               	.LM267:
 2220 0746 1092 0000 		sts bmac_task+31,__zero_reg__
 2221 074a 1092 0000 		sts bmac_task+31+1,__zero_reg__
 2222 074e 1092 0000 		sts bmac_task+31+2,__zero_reg__
 2223 0752 1092 0000 		sts bmac_task+31+3,__zero_reg__
 658:../../../src/net/bmac/rf231_soc/bmac.c **** #ifdef DEBUG
 659:../../../src/net/bmac/rf231_soc/bmac.c ****   printf ("bmac activate\r\n");
 660:../../../src/net/bmac/rf231_soc/bmac.c **** #endif
 661:../../../src/net/bmac/rf231_soc/bmac.c ****   nrk_activate_task (&bmac_task);
 2225               	.LM268:
 2226 0756 80E0      		ldi r24,lo8(bmac_task)
 2227 0758 90E0      		ldi r25,hi8(bmac_task)
 2228 075a 0C94 0000 		jmp nrk_activate_task
 2230               	.Lscope40:
 2232               		.stabd	78,0,0
 2233               		.section	.progmem.data,"a",@progbits
 2236               	__c.3637:
 2237 0000 4661 696C 		.string	"Failed to register signal\r\n"
 2237      6564 2074 
 2237      6F20 7265 
 2237      6769 7374 
 2237      6572 2073 
 2240               	__c.3611:
 2241 001c 424D 4143 		.string	"BMAC TX: Woke up on wrong signal\r\n"
 2241      2054 583A 
 2241      2057 6F6B 
 2241      6520 7570 
 2241      206F 6E20 
 2244               	__c.3609:
 2245 003f 424D 4143 		.string	"BMAC TX: Error calling event wait\r\n"
 2245      2054 583A 
 2245      2045 7272 
 2245      6F72 2063 
 2245      616C 6C69 
 2248               	__c.3593:
 2249 0063 424D 4143 		.string	"BMAC ERROR: creating enable signal failed\r\n"
 2249      2045 5252 
 2249      4F52 3A20 
 2249      6372 6561 
 2249      7469 6E67 
 2252               	__c.3591:
 2253 008f 424D 4143 		.string	"BMAC ERROR: creating tx signal failed\r\n"
 2253      2045 5252 
 2253      4F52 3A20 
 2253      6372 6561 
 2253      7469 6E67 
 2256               	__c.3589:
 2257 00b7 424D 4143 		.string	"BMAC ERROR: creating rx signal failed\r\n"
 2257      2045 5252 
 2257      4F52 3A20 
 2257      6372 6561 
 2257      7469 6E67 
 2258               		.local	dummy_t
 2259               		.comm	dummy_t,8,1
 2260               		.local	tx_reserve
 2261               		.comm	tx_reserve,1,1
 2262               		.local	cca_active
 2263               		.comm	cca_active,1,1
 2264               		.local	_bmac_check_period
 2265               		.comm	_bmac_check_period,8,1
 2266               		.local	is_enabled
 2267               		.comm	is_enabled,1,1
 2268               		.local	g_chan
 2269               		.comm	g_chan,1,1
 2270               		.local	pkt_got_ack
 2271               		.comm	pkt_got_ack,1,1
 2272               		.local	bmac_running
 2273               		.comm	bmac_running,1,1
 2274               		.local	rx_buf_empty
 2275               		.comm	rx_buf_empty,1,1
 2276               		.local	tx_data_ready
 2277               		.comm	tx_data_ready,1,1
 2278               		.local	rx_failure_cnt
 2279               		.comm	rx_failure_cnt,4,1
 2280               		.local	bmac_task_stack
 2281               		.comm	bmac_task_stack,256,1
 2282               		.local	bmac_task
 2283               		.comm	bmac_task,35,1
 2284               		.comm	bmac_rfTxInfo,7,1
 2285               		.comm	bmac_rfRxInfo,12,1
 2286               		.comm	bmac_enable_signal,1,1
 2287               		.comm	bmac_tx_pkt_done_signal,1,1
 2288               		.comm	bmac_rx_pkt_signal,1,1
 2289               		.comm	error_num,1,1
 2290               		.comm	error_task,1,1
 2291               		.comm	app_timer0_prescale,1,1
 2292               		.comm	app_timer0_callback,2,1
 2293               		.comm	_nrk_time_trigger,1,1
 2294               		.comm	_nrk_prev_timer_val,1,1
 2295               		.comm	nrk_kernel_stk_ptr,2,1
 2296               		.comm	nrk_idle_task_stk,256,1
 2297               		.comm	_nrk_signal_list,4,1
 2325               		.text
 2327               	.Letext0:
 2328               		.ident	"GCC: (GNU) 4.8.2"
 2329               	.global __do_clear_bss
DEFINED SYMBOLS
                            *ABS*:0000000000000000 bmac.c
     /tmp/ccXRwroS.s:2      *ABS*:000000000000003e __SP_H__
     /tmp/ccXRwroS.s:3      *ABS*:000000000000003d __SP_L__
     /tmp/ccXRwroS.s:4      *ABS*:000000000000003f __SREG__
     /tmp/ccXRwroS.s:5      *ABS*:000000000000003b __RAMPZ__
     /tmp/ccXRwroS.s:6      *ABS*:0000000000000000 __tmp_reg__
     /tmp/ccXRwroS.s:7      *ABS*:0000000000000001 __zero_reg__
     /tmp/ccXRwroS.s:341    .text:0000000000000000 rf_rx_callback
     /tmp/ccXRwroS.s:362    .text:0000000000000002 bmac_encryption_set_ctr_counter
     /tmp/ccXRwroS.s:398    .text:0000000000000012 bmac_tx_reserve_set
     /tmp/ccXRwroS.s:418    .text:0000000000000016 bmac_tx_reserve_get
     /tmp/ccXRwroS.s:439    .text:000000000000001c bmac_auto_ack_disable
     /tmp/ccXRwroS.s:462    .text:0000000000000024 bmac_auto_ack_enable
     /tmp/ccXRwroS.s:485    .text:000000000000002c bmac_addr_decode_disable
     /tmp/ccXRwroS.s:508    .text:0000000000000034 bmac_addr_decode_enable
     /tmp/ccXRwroS.s:532    .text:000000000000003c bmac_addr_decode_set_my_mac
     /tmp/ccXRwroS.s:556    .text:0000000000000044 bmac_addr_decode_dest_mac
                            *COM*:0000000000000007 bmac_rfTxInfo
     /tmp/ccXRwroS.s:580    .text:0000000000000050 bmac_rx_pkt_is_encrypted
     /tmp/ccXRwroS.s:604    .text:0000000000000056 bmac_encryption_set_key
     /tmp/ccXRwroS.s:638    .text:0000000000000066 bmac_encryption_enable
     /tmp/ccXRwroS.s:658    .text:000000000000006a bmac_encryption_disable
     /tmp/ccXRwroS.s:679    .text:000000000000006e bmac_set_rf_power
     /tmp/ccXRwroS.s:714    .text:000000000000007e bmac_set_cca_active
     /tmp/ccXRwroS.s:2261   .bss:0000000000000009 cca_active
     /tmp/ccXRwroS.s:735    .text:0000000000000084 bmac_set_cca_thresh
     /tmp/ccXRwroS.s:762    .text:0000000000000092 bmac_set_channel
     /tmp/ccXRwroS.s:2267   .bss:0000000000000013 g_chan
                            *COM*:000000000000000c bmac_rfRxInfo
     /tmp/ccXRwroS.s:821    .text:00000000000000cc bmac_wait_until_rx_pkt
     /tmp/ccXRwroS.s:2273   .bss:0000000000000016 rx_buf_empty
                            *COM*:0000000000000001 bmac_rx_pkt_signal
     /tmp/ccXRwroS.s:890    .text:0000000000000118 bmac_rx_pkt_set_buffer
     /tmp/ccXRwroS.s:932    .text:0000000000000134 bmac_init
     /tmp/ccXRwroS.s:2271   .bss:0000000000000015 bmac_running
     /tmp/ccXRwroS.s:2259   .bss:0000000000000008 tx_reserve
     /tmp/ccXRwroS.s:2277   .bss:0000000000000018 rx_failure_cnt
     /tmp/ccXRwroS.s:2263   .bss:000000000000000a _bmac_check_period
     /tmp/ccXRwroS.s:2256   .progmem.data:00000000000000b7 __c.3589
                            *COM*:0000000000000001 bmac_tx_pkt_done_signal
     /tmp/ccXRwroS.s:2252   .progmem.data:000000000000008f __c.3591
                            *COM*:0000000000000001 bmac_enable_signal
     /tmp/ccXRwroS.s:2248   .progmem.data:0000000000000063 __c.3593
     /tmp/ccXRwroS.s:2275   .bss:0000000000000017 tx_data_ready
     /tmp/ccXRwroS.s:2265   .bss:0000000000000012 is_enabled
     /tmp/ccXRwroS.s:1090   .text:0000000000000214 bmac_tx_pkt_nonblocking
     /tmp/ccXRwroS.s:1133   .text:0000000000000236 bmac_get_rx_pkt_signal
     /tmp/ccXRwroS.s:1157   .text:0000000000000244 bmac_get_tx_done_signal
     /tmp/ccXRwroS.s:1183   .text:0000000000000252 bmac_tx_pkt
     /tmp/ccXRwroS.s:2244   .progmem.data:000000000000003f __c.3609
     /tmp/ccXRwroS.s:2240   .progmem.data:000000000000001c __c.3611
     /tmp/ccXRwroS.s:2269   .bss:0000000000000014 pkt_got_ack
     /tmp/ccXRwroS.s:1313   .text:00000000000002fc bmac_rx_pkt_get
     /tmp/ccXRwroS.s:1365   .text:000000000000032c bmac_rx_pkt_ready
     /tmp/ccXRwroS.s:1391   .text:0000000000000338 bmac_rx_pkt_release
     /tmp/ccXRwroS.s:1414   .text:0000000000000340 bmac_disable
     /tmp/ccXRwroS.s:1436   .text:0000000000000348 bmac_enable
     /tmp/ccXRwroS.s:1464   .text:000000000000035a bmac_set_rx_check_rate
     /tmp/ccXRwroS.s:1557   .text:00000000000003e0 bmac_started
     /tmp/ccXRwroS.s:1577   .text:00000000000003e6 _bmac_channel_check
     /tmp/ccXRwroS.s:1622   .text:000000000000040e _bmac_rx
                             .bss:0000000000000000 dummy_t
     /tmp/ccXRwroS.s:1715   .text:000000000000049e bmac_rx_failure_count_get
     /tmp/ccXRwroS.s:1736   .text:00000000000004a8 bmac_rx_failure_count_reset
     /tmp/ccXRwroS.s:1763   .text:00000000000004bc _b_pow
     /tmp/ccXRwroS.s:1823   .text:00000000000004dc _bmac_tx
     /tmp/ccXRwroS.s:2004   .text:00000000000005f4 bmac_nw_task
     /tmp/ccXRwroS.s:2236   .progmem.data:0000000000000000 __c.3637
     /tmp/ccXRwroS.s:2145   .text:00000000000006be bmac_task_config
     /tmp/ccXRwroS.s:2281   .bss:000000000000011c bmac_task
     /tmp/ccXRwroS.s:2279   .bss:000000000000001c bmac_task_stack
                            *COM*:0000000000000001 error_num
                            *COM*:0000000000000001 error_task
                            *COM*:0000000000000001 app_timer0_prescale
                            *COM*:0000000000000002 app_timer0_callback
                            *COM*:0000000000000001 _nrk_time_trigger
                            *COM*:0000000000000001 _nrk_prev_timer_val
                            *COM*:0000000000000002 nrk_kernel_stk_ptr
                            *COM*:0000000000000100 nrk_idle_task_stk
                            *COM*:0000000000000004 _nrk_signal_list

UNDEFINED SYMBOLS
rf_security_set_ctr_counter
rf_auto_ack_disable
rf_auto_ack_enable
rf_addr_decode_disable
rf_addr_decode_enable
rf_addr_decode_set_my_mac
rf_security_last_pkt_status
rf_security_set_key
rf_tx_power
rf_set_cca_thresh
rf_power_up
rf_init
nrk_signal_register
nrk_event_wait
nrk_signal_create
nrk_kprintf
nrk_cur_task_TCB
nrk_kernel_error_add
rf_power_down
nrk_event_signal
rf_rx_on
rf_cca_check
rf_rx_off
nrk_wait
rf_rx_packet_nonblock
_nrk_time_to_ticks
rand
__divmodhi4
__udivmodhi4
nrk_wait_until_ticks
nrk_wait_until_next_n_periods
__udivmodsi4
rf_tx_packet_repeat
nrk_wait_until_next_period
nrk_task_set_entry_function
nrk_task_set_stk
nrk_activate_task
__do_clear_bss
